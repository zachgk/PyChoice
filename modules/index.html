
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A library for manging choices, options, and configurations across abstraction hierarchy">
      
      
        <meta name="author" content="Zach Kimberg">
      
      
        <link rel="canonical" href="https://zachgk.github.io/PyChoice/modules/">
      
      
        <link rel="prev" href="../rules/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>API Reference - PyChoice</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyChoice" class="md-header__button md-logo" aria-label="PyChoice" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyChoice
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zachgk/PyChoice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zachgk/PyChoice
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyChoice" class="md-nav__button md-logo" aria-label="PyChoice" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyChoice
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zachgk/PyChoice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    zachgk/PyChoice
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rules
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-functions-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Functions Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs" class="md-nav__link">
    <span class="md-ellipsis">
      funcs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceFunction" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceFunction.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceJSONEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceJSONEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceJSONEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceJSONEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Match" class="md-nav__link">
    <span class="md-ellipsis">
      Match
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Match">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.capture" class="md-nav__link">
    <span class="md-ellipsis">
      capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.MismatchedTrace" class="md-nav__link">
    <span class="md-ellipsis">
      MismatchedTrace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.NonRule" class="md-nav__link">
    <span class="md-ellipsis">
      NonRule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Trace" class="md-nav__link">
    <span class="md-ellipsis">
      Trace
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Trace.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem" class="md-nav__link">
    <span class="md-ellipsis">
      TraceItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TraceItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.print_item" class="md-nav__link">
    <span class="md-ellipsis">
      print_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus" class="md-nav__link">
    <span class="md-ellipsis">
      TraceStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TraceStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.call_begin" class="md-nav__link">
    <span class="md-ellipsis">
      call_begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.call_end" class="md-nav__link">
    <span class="md-ellipsis">
      call_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tracing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing.begin" class="md-nav__link">
    <span class="md-ellipsis">
      begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing.end" class="md-nav__link">
    <span class="md-ellipsis">
      end
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.def_rule" class="md-nav__link">
    <span class="md-ellipsis">
      def_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.func" class="md-nav__link">
    <span class="md-ellipsis">
      func
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.impl" class="md-nav__link">
    <span class="md-ellipsis">
      impl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.new_selector" class="md-nav__link">
    <span class="md-ellipsis">
      new_selector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.new_selector_item" class="md-nav__link">
    <span class="md-ellipsis">
      new_selector_item
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.rule" class="md-nav__link">
    <span class="md-ellipsis">
      rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.wrap" class="md-nav__link">
    <span class="md-ellipsis">
      wrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments-and-rules-module" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments and Rules Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args" class="md-nav__link">
    <span class="md-ellipsis">
      args
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceFuncImplementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceFuncImplementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.choice_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      choice_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.MatchedRule" class="md-nav__link">
    <span class="md-ellipsis">
      MatchedRule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.MissingChoiceArg" class="md-nav__link">
    <span class="md-ellipsis">
      MissingChoiceArg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.Rule" class="md-nav__link">
    <span class="md-ellipsis">
      Rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.Selector" class="md-nav__link">
    <span class="md-ellipsis">
      Selector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.all_matches" class="md-nav__link">
    <span class="md-ellipsis">
      all_matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.choice_function" class="md-nav__link">
    <span class="md-ellipsis">
      choice_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.compare" class="md-nav__link">
    <span class="md-ellipsis">
      compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.generic_compare" class="md-nav__link">
    <span class="md-ellipsis">
      generic_compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selector-classes-module" class="md-nav__link">
    <span class="md-ellipsis">
      Selector Classes Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector" class="md-nav__link">
    <span class="md-ellipsis">
      selector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      CallableSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CallableSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContext" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContextSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceContextSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      ClassSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClassSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.InvalidSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InvalidSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.InvalidSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.NonFunction" class="md-nav__link">
    <span class="md-ellipsis">
      NonFunction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      SelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poset-visualization-module" class="md-nav__link">
    <span class="md-ellipsis">
      Poset Visualization Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset" class="md-nav__link">
    <span class="md-ellipsis">
      poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset.build_selector_poset" class="md-nav__link">
    <span class="md-ellipsis">
      build_selector_poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset.visualize_selector_poset" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_selector_poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tracing-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice" class="md-nav__link">
    <span class="md-ellipsis">
      pychoice
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.ChoiceContext" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.Match" class="md-nav__link">
    <span class="md-ellipsis">
      Match
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Match">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.capture" class="md-nav__link">
    <span class="md-ellipsis">
      capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.MissingChoiceArg" class="md-nav__link">
    <span class="md-ellipsis">
      MissingChoiceArg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.def_rule" class="md-nav__link">
    <span class="md-ellipsis">
      def_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.func" class="md-nav__link">
    <span class="md-ellipsis">
      func
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.impl" class="md-nav__link">
    <span class="md-ellipsis">
      impl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.rule" class="md-nav__link">
    <span class="md-ellipsis">
      rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.trace_start" class="md-nav__link">
    <span class="md-ellipsis">
      trace_start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.trace_stop" class="md-nav__link">
    <span class="md-ellipsis">
      trace_stop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.wrap" class="md-nav__link">
    <span class="md-ellipsis">
      wrap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-functions-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Functions Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs" class="md-nav__link">
    <span class="md-ellipsis">
      funcs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceFunction" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceFunction.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceJSONEncoder" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceJSONEncoder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceJSONEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.ChoiceJSONEncoder.default" class="md-nav__link">
    <span class="md-ellipsis">
      default
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Match" class="md-nav__link">
    <span class="md-ellipsis">
      Match
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Match">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.capture" class="md-nav__link">
    <span class="md-ellipsis">
      capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Match.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.MismatchedTrace" class="md-nav__link">
    <span class="md-ellipsis">
      MismatchedTrace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.NonRule" class="md-nav__link">
    <span class="md-ellipsis">
      NonRule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Trace" class="md-nav__link">
    <span class="md-ellipsis">
      Trace
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Trace.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem" class="md-nav__link">
    <span class="md-ellipsis">
      TraceItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TraceItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.print_item" class="md-nav__link">
    <span class="md-ellipsis">
      print_item
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceItem.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus" class="md-nav__link">
    <span class="md-ellipsis">
      TraceStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TraceStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.call_begin" class="md-nav__link">
    <span class="md-ellipsis">
      call_begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.call_end" class="md-nav__link">
    <span class="md-ellipsis">
      call_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.TraceStatus.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tracing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing.begin" class="md-nav__link">
    <span class="md-ellipsis">
      begin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.funcs.Tracing.end" class="md-nav__link">
    <span class="md-ellipsis">
      end
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.def_rule" class="md-nav__link">
    <span class="md-ellipsis">
      def_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.func" class="md-nav__link">
    <span class="md-ellipsis">
      func
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.impl" class="md-nav__link">
    <span class="md-ellipsis">
      impl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.new_selector" class="md-nav__link">
    <span class="md-ellipsis">
      new_selector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.new_selector_item" class="md-nav__link">
    <span class="md-ellipsis">
      new_selector_item
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.rule" class="md-nav__link">
    <span class="md-ellipsis">
      rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.funcs.wrap" class="md-nav__link">
    <span class="md-ellipsis">
      wrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments-and-rules-module" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments and Rules Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args" class="md-nav__link">
    <span class="md-ellipsis">
      args
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceFuncImplementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceFuncImplementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.ChoiceFuncImplementation.choice_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      choice_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.MatchedRule" class="md-nav__link">
    <span class="md-ellipsis">
      MatchedRule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.MissingChoiceArg" class="md-nav__link">
    <span class="md-ellipsis">
      MissingChoiceArg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.Rule" class="md-nav__link">
    <span class="md-ellipsis">
      Rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.args.Selector" class="md-nav__link">
    <span class="md-ellipsis">
      Selector
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Selector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.all_matches" class="md-nav__link">
    <span class="md-ellipsis">
      all_matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.choice_function" class="md-nav__link">
    <span class="md-ellipsis">
      choice_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.compare" class="md-nav__link">
    <span class="md-ellipsis">
      compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.generic_compare" class="md-nav__link">
    <span class="md-ellipsis">
      generic_compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.args.Selector.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selector-classes-module" class="md-nav__link">
    <span class="md-ellipsis">
      Selector Classes Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector" class="md-nav__link">
    <span class="md-ellipsis">
      selector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      CallableSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CallableSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.CallableSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContext" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContextSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChoiceContextSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ChoiceContextSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      ClassSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClassSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.ClassSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.FunctionSelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.InvalidSelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidSelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InvalidSelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.InvalidSelectorItem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.NonFunction" class="md-nav__link">
    <span class="md-ellipsis">
      NonFunction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem" class="md-nav__link">
    <span class="md-ellipsis">
      SelectorItem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SelectorItem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.selector.SelectorItem.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poset-visualization-module" class="md-nav__link">
    <span class="md-ellipsis">
      Poset Visualization Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset" class="md-nav__link">
    <span class="md-ellipsis">
      poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset.build_selector_poset" class="md-nav__link">
    <span class="md-ellipsis">
      build_selector_poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.poset.visualize_selector_poset" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_selector_poset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tracing-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Tracing Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice" class="md-nav__link">
    <span class="md-ellipsis">
      pychoice
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.ChoiceContext" class="md-nav__link">
    <span class="md-ellipsis">
      ChoiceContext
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.Match" class="md-nav__link">
    <span class="md-ellipsis">
      Match
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Match">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.capture" class="md-nav__link">
    <span class="md-ellipsis">
      capture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.get_callable" class="md-nav__link">
    <span class="md-ellipsis">
      get_callable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pychoice.Match.matches" class="md-nav__link">
    <span class="md-ellipsis">
      matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.MissingChoiceArg" class="md-nav__link">
    <span class="md-ellipsis">
      MissingChoiceArg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.def_rule" class="md-nav__link">
    <span class="md-ellipsis">
      def_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.func" class="md-nav__link">
    <span class="md-ellipsis">
      func
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.impl" class="md-nav__link">
    <span class="md-ellipsis">
      impl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.rule" class="md-nav__link">
    <span class="md-ellipsis">
      rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.trace_start" class="md-nav__link">
    <span class="md-ellipsis">
      trace_start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.trace_stop" class="md-nav__link">
    <span class="md-ellipsis">
      trace_stop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pychoice.wrap" class="md-nav__link">
    <span class="md-ellipsis">
      wrap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="core-functions-module">Core Functions Module<a class="headerlink" href="#core-functions-module" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pychoice.funcs"></a>
    <div class="doc doc-contents first">

        <p>Core functionality for PyChoice - choice functions, decorators, and tracing.</p>
<p>This module contains the primary implementation of choice functions, including
decorators for creating choice functions and implementations, tracing capabilities,
and the core ChoiceFunction class that handles rule matching and execution.</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="pychoice.funcs.registry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">registry</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pychoice.funcs.registry" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Global registry of all ChoiceFunctions created with @func decorator.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.ChoiceFunction" class="doc doc-heading">
            <code>ChoiceFunction</code>


<a href="#pychoice.funcs.ChoiceFunction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>The core choice function that manages rules and dispatches to implementations.</p>
<p>ChoiceFunction is created by the @func decorator and serves as the central
orchestrator for choice-based function calls. It maintains a registry of
rules and alternative implementations, selecting the most appropriate one
based on the current call stack.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.ChoiceFunction.id">id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for this choice function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.ChoiceFunction.interface">interface</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default ChoiceFuncImplementation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.ChoiceFunction.funcs">funcs</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="uuid.UUID">UUID</span>, <a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of alternative implementations by UUID</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.ChoiceFunction.rules">rules</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Rule


  
      dataclass
   (pychoice.args.Rule)" href="#pychoice.args.Rule">Rule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of rules that apply to this choice function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func(args=[&quot;greeting&quot;])
def greet(name: str, greeting=&quot;Hello&quot;):
    return f&quot;{greeting} {name}&quot;
# greet is now a ChoiceFunction instance
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The core choice function that manages rules and dispatches to implementations.</span>

<span class="sd">    ChoiceFunction is created by the @func decorator and serves as the central</span>
<span class="sd">    orchestrator for choice-based function calls. It maintains a registry of</span>
<span class="sd">    rules and alternative implementations, selecting the most appropriate one</span>
<span class="sd">    based on the current call stack.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        id: Unique identifier for this choice function</span>
<span class="sd">        interface: The default ChoiceFuncImplementation</span>
<span class="sd">        funcs: Dictionary of alternative implementations by UUID</span>
<span class="sd">        rules: List of rules that apply to this choice function</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func(args=[&quot;greeting&quot;])</span>
<span class="sd">        def greet(name: str, greeting=&quot;Hello&quot;):</span>
<span class="sd">            return f&quot;{greeting} {name}&quot;</span>
<span class="sd">        # greet is now a ChoiceFunction instance</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a ChoiceFunction with a default implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            interface: The default ChoiceFuncImplementation to use</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">uuid5</span><span class="p">(</span><span class="n">UUID_NAMESPACE</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]</span> <span class="o">=</span> <span class="n">interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funcs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">UUID</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Rule</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ChoiceFunction(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an alternative implementation to this choice function.</span>

<span class="sd">        Args:</span>
<span class="sd">            f: The original function (unused but kept for compatibility)</span>
<span class="sd">            func: The ChoiceFuncImplementation to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funcs</span><span class="p">[</span><span class="n">func</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a rule to this choice function.</span>

<span class="sd">        Args:</span>
<span class="sd">            rule: The Rule to add to the rule list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sorted_selectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">OptStackFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get matching rules sorted by specificity.</span>

<span class="sd">        Args:</span>
<span class="sd">            stack_info: Optional stack frames, uses current stack if None</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of MatchedRules sorted from least to most specific</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">stack_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

        <span class="c1"># Get indices and filter to only matching</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="n">matched_rule</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">stack_info</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matched_rule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matched_rule</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rules</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">MatchedRule</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">MatchedRule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">selector</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

        <span class="c1"># Sort</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="n">compare</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">rules</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">O</span><span class="p">:</span>
        <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sorted_selectors</span><span class="p">(</span><span class="n">stack_info</span><span class="p">)</span>

        <span class="n">impl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">rules</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">impl</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">impl</span>  <span class="c1"># Override with best matched rule if one is applicable</span>
                <span class="k">break</span>

        <span class="c1"># Prune non-matching implementations for arg overrides</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rules</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">impl</span> <span class="o">==</span> <span class="n">impl</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">rule</span><span class="o">.</span><span class="n">impl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
            <span class="n">impl</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">interface</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NonRule</span><span class="p">()</span>

        <span class="n">choice_kwargs</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="n">trace_status</span><span class="o">.</span><span class="n">call_begin</span><span class="p">(</span><span class="n">TraceItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impl</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">choice_kwargs</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">choice_kwargs</span><span class="p">)</span>
        <span class="n">trace_status</span><span class="o">.</span><span class="n">call_end</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.ChoiceFunction.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span></code>

<a href="#pychoice.funcs.ChoiceFunction.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize a ChoiceFunction with a default implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>interface</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default ChoiceFuncImplementation to use</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a ChoiceFunction with a default implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        interface: The default ChoiceFuncImplementation to use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">uuid5</span><span class="p">(</span><span class="n">UUID_NAMESPACE</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]</span> <span class="o">=</span> <span class="n">interface</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">funcs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">UUID</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Rule</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.ChoiceJSONEncoder" class="doc doc-heading">
            <code>ChoiceJSONEncoder</code>


<a href="#pychoice.funcs.ChoiceJSONEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="json.JSONEncoder">JSONEncoder</span></code></p>


        <p>Custom JSON encoder for PyChoice objects.</p>
<p>This encoder handles serialization of PyChoice-specific objects like
TraceItems, Traces, ChoiceFunctions, and Rules into JSON format.
It's used primarily for trace serialization and debugging.</p>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">trace_data = json.dumps(trace, cls=ChoiceJSONEncoder, indent=2)
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceJSONEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom JSON encoder for PyChoice objects.</span>

<span class="sd">    This encoder handles serialization of PyChoice-specific objects like</span>
<span class="sd">    TraceItems, Traces, ChoiceFunctions, and Rules into JSON format.</span>
<span class="sd">    It&#39;s used primarily for trace serialization and debugging.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        trace_data = json.dumps(trace, cls=ChoiceJSONEncoder, indent=2)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert PyChoice objects to JSON-serializable dictionaries.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj: Object to serialize</span>

<span class="sd">        Returns:</span>
<span class="sd">            JSON-serializable representation of the object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">TraceItem</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Trace</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">],</span> <span class="s2">&quot;registry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">id</span><span class="p">):</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">registry</span><span class="p">}}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
                <span class="s2">&quot;funcs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">funcs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
                <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)),</span>
                <span class="s2">&quot;module&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__module__&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="s2">&quot;defaults&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Rule</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selector</span><span class="p">),</span>
                <span class="s2">&quot;impl&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
                <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">MatchedRule</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">rule</span><span class="p">,</span>
                <span class="s2">&quot;captures&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">captures</span><span class="p">,</span>
                <span class="s2">&quot;vals&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.ChoiceJSONEncoder.default" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

<a href="#pychoice.funcs.ChoiceJSONEncoder.default" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert PyChoice objects to JSON-serializable dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object to serialize</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON-serializable representation of the object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert PyChoice objects to JSON-serializable dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: Object to serialize</span>

<span class="sd">    Returns:</span>
<span class="sd">        JSON-serializable representation of the object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">TraceItem</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Trace</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">],</span> <span class="s2">&quot;registry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">id</span><span class="p">):</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">registry</span><span class="p">}}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
            <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
            <span class="s2">&quot;funcs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">funcs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
            <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)),</span>
            <span class="s2">&quot;module&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__module__&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;defaults&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Rule</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">selector</span><span class="p">),</span>
            <span class="s2">&quot;impl&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">MatchedRule</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">rule</span><span class="p">,</span>
            <span class="s2">&quot;captures&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">captures</span><span class="p">,</span>
            <span class="s2">&quot;vals&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.Match" class="doc doc-heading">
            <code>Match</code>


<a href="#pychoice.funcs.Match" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Advanced selector item that matches function calls with specific argument values.</p>
<p>Match extends basic function matching to also check argument values, allowing
for more precise rule targeting based on function parameters.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.Match.item">item</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The underlying SelectorItem to match</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.Match.match_kwargs">match_kwargs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments that must match for this selector to apply</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Match greet() calls where greeting=&quot;Hi&quot;
match_item = Match(greet, greeting=&quot;Hi&quot;)
selector = Selector([my_app, match_item])
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Match</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Advanced selector item that matches function calls with specific argument values.</span>

<span class="sd">    Match extends basic function matching to also check argument values, allowing</span>
<span class="sd">    for more precise rule targeting based on function parameters.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        item: The underlying SelectorItem to match</span>
<span class="sd">        match_kwargs: Keyword arguments that must match for this selector to apply</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Match greet() calls where greeting=&quot;Hi&quot;</span>
<span class="sd">        match_item = Match(greet, greeting=&quot;Hi&quot;)</span>
<span class="sd">        selector = Selector([my_app, match_item])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">SEL_I</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">new_selector_item</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Match</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">item</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">match_kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying callable from the wrapped selector item.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this Match selector matches a stack frame.</span>

<span class="sd">        First checks if the underlying item matches, then verifies that</span>
<span class="sd">        all specified keyword arguments match the actual call arguments.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check for matching</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if both function and arguments match, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First check if the underlying item matches</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># If no kwargs to match, then it&#39;s a match</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Capture the arguments and compare against expected kwargs</span>
        <span class="n">captured</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>

        <span class="c1"># Check if all expected kwargs match the captured values</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">expected_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captured</span> <span class="ow">or</span> <span class="n">captured</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">capture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture local variables from the matching stack frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to capture variables from</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of captured local variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Match.capture" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.funcs.Match.capture" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Capture local variables from the matching stack frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to capture variables from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of captured local variables</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">capture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Capture local variables from the matching stack frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to capture variables from</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of captured local variables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Match.get_callable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_callable</span><span class="p">()</span></code>

<a href="#pychoice.funcs.Match.get_callable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the underlying callable from the wrapped selector item.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the underlying callable from the wrapped selector item.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Match.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.funcs.Match.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if this Match selector matches a stack frame.</p>
<p>First checks if the underlying item matches, then verifies that
all specified keyword arguments match the actual call arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check for matching</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if both function and arguments match, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this Match selector matches a stack frame.</span>

<span class="sd">    First checks if the underlying item matches, then verifies that</span>
<span class="sd">    all specified keyword arguments match the actual call arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check for matching</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if both function and arguments match, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First check if the underlying item matches</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># If no kwargs to match, then it&#39;s a match</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Capture the arguments and compare against expected kwargs</span>
    <span class="n">captured</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>

    <span class="c1"># Check if all expected kwargs match the captured values</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">expected_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captured</span> <span class="ow">or</span> <span class="n">captured</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected_value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.MismatchedTrace" class="doc doc-heading">
            <code>MismatchedTrace</code>


<a href="#pychoice.funcs.MismatchedTrace" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="RuntimeError">RuntimeError</span></code></p>


        <p>Exception raised when trace begin/end calls are mismatched.</p>
<p>This occurs when trace_end() is called without a corresponding
trace_begin(), indicating a bug in the tracing logic.</p>







              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MismatchedTrace</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when trace begin/end calls are mismatched.</span>

<span class="sd">    This occurs when trace_end() is called without a corresponding</span>
<span class="sd">    trace_begin(), indicating a bug in the tracing logic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Mismatched choice Trace end call&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.NonRule" class="doc doc-heading">
            <code>NonRule</code>


<a href="#pychoice.funcs.NonRule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when an invalid rule implementation is provided.</p>
<p>This occurs when trying to create a rule with something that is not
a ChoiceFunction or ChoiceFuncImplementation.</p>







              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NonRule</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an invalid rule implementation is provided.</span>

<span class="sd">    This occurs when trying to create a rule with something that is not</span>
<span class="sd">    a ChoiceFunction or ChoiceFuncImplementation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Expected a choice function for the rule impl&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.Trace" class="doc doc-heading">
            <code>Trace</code>


<a href="#pychoice.funcs.Trace" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Contains the complete trace of choice function calls.</p>
<p>A Trace represents the final result of tracing, containing all
choice function invocations that occurred during the traced period.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.Trace.items">items</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of top-level TraceItems representing the call hierarchy</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">trace_start()
my_application()  # Contains choice function calls
trace = trace_stop()
print(trace)  # Shows all choice decisions made
trace.save(&quot;choices.json&quot;)  # Save for analysis
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Trace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains the complete trace of choice function calls.</span>

<span class="sd">    A Trace represents the final result of tracing, containing all</span>
<span class="sd">    choice function invocations that occurred during the traced period.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        items: List of top-level TraceItems representing the call hierarchy</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        trace_start()</span>
<span class="sd">        my_application()  # Contains choice function calls</span>
<span class="sd">        trace = trace_stop()</span>
<span class="sd">        print(trace)  # Shows all choice decisions made</span>
<span class="sd">        trace.save(&quot;choices.json&quot;)  # Save for analysis</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracing</span><span class="p">:</span> <span class="n">Tracing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">tracing</span><span class="o">.</span><span class="n">items</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">sb</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">print_item</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save trace to JSON file for analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: Path to save the JSON trace file</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            trace.save(&quot;debug_choices.json&quot;)</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ChoiceJSONEncoder</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Trace.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#pychoice.funcs.Trace.save" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save trace to JSON file for analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the JSON trace file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">trace.save(&quot;debug_choices.json&quot;)
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save trace to JSON file for analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: Path to save the JSON trace file</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        trace.save(&quot;debug_choices.json&quot;)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ChoiceJSONEncoder</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.TraceItem" class="doc doc-heading">
            <code>TraceItem</code>


<a href="#pychoice.funcs.TraceItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Represents a single choice function call in a trace.</p>
<p>TraceItems capture the complete context of a choice function invocation,
including which implementation was used, what rules applied, and the
arguments involved. They form a hierarchical structure to represent
nested choice function calls.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.func">func</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction that was called</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.impl">impl</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFuncImplementation that was executed</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.rules">rules</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of MatchedRules that applied to this call</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.stack_info">stack_info</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Call stack information at time of invocation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.args">args</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments passed to the function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.kwargs">kwargs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments passed to the function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.choice_kwargs">choice_kwargs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final keyword arguments after rule application</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceItem.items">items</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="TraceItem (pychoice.funcs.TraceItem)" href="#pychoice.funcs.TraceItem">TraceItem</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of nested TraceItems for sub-calls</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TraceItem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a single choice function call in a trace.</span>

<span class="sd">    TraceItems capture the complete context of a choice function invocation,</span>
<span class="sd">    including which implementation was used, what rules applied, and the</span>
<span class="sd">    arguments involved. They form a hierarchical structure to represent</span>
<span class="sd">    nested choice function calls.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        func: The ChoiceFunction that was called</span>
<span class="sd">        impl: The ChoiceFuncImplementation that was executed</span>
<span class="sd">        rules: List of MatchedRules that applied to this call</span>
<span class="sd">        stack_info: Call stack information at time of invocation</span>
<span class="sd">        args: Positional arguments passed to the function</span>
<span class="sd">        kwargs: Keyword arguments passed to the function</span>
<span class="sd">        choice_kwargs: Final keyword arguments after rule application</span>
<span class="sd">        items: List of nested TraceItems for sub-calls</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">,</span>
        <span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">,</span>
        <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span>
        <span class="n">stack_info</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">],</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
        <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">choice_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a TraceItem with complete call context.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The ChoiceFunction that was invoked</span>
<span class="sd">            impl: The implementation that was selected and executed</span>
<span class="sd">            rules: List of rules that matched and applied</span>
<span class="sd">            stack_info: Call stack frames at time of invocation</span>
<span class="sd">            args: Positional arguments to the function</span>
<span class="sd">            kwargs: Original keyword arguments </span>
<span class="sd">            choice_kwargs: Final keyword arguments after rule processing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="o">=</span> <span class="n">impl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack_info</span> <span class="o">=</span> <span class="n">stack_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span> <span class="o">=</span> <span class="n">choice_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TraceItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sb</span><span class="p">:</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print formatted representation of this trace item.</span>

<span class="sd">        Args:</span>
<span class="sd">            sb: Text buffer to write output to</span>
<span class="sd">            indent: Indentation level for nested display</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span>
        <span class="n">rule_str</span> <span class="o">=</span> <span class="s2">&quot; -&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;No rules&quot;</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">  Args: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s2">, Kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">, Choice Kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">  Rules: </span><span class="si">{</span><span class="n">rule_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sub_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">sub_item</span><span class="o">.</span><span class="n">print_item</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert trace item to dictionary representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary representation suitable for JSON serialization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
            <span class="s2">&quot;impl&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
            <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span>
            <span class="s2">&quot;stack_info&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">function</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_info</span><span class="p">],</span>
            <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">],</span>
            <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;choice_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">],</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">impl</span><span class="p">,</span> <span class="n">rules</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">choice_kwargs</span><span class="p">)</span></code>

<a href="#pychoice.funcs.TraceItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize a TraceItem with complete call context.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction that was invoked</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impl</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The implementation that was selected and executed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="MatchedRule (pychoice.args.MatchedRule)" href="#pychoice.args.MatchedRule">MatchedRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of rules that matched and applied</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stack_info</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="inspect.FrameInfo">FrameInfo</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Call stack frames at time of invocation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="typing.Any">Any</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments to the function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original keyword arguments </p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>choice_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final keyword arguments after rule processing</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">,</span>
    <span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span><span class="p">,</span>
    <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span>
    <span class="n">stack_info</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">],</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">choice_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a TraceItem with complete call context.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The ChoiceFunction that was invoked</span>
<span class="sd">        impl: The implementation that was selected and executed</span>
<span class="sd">        rules: List of rules that matched and applied</span>
<span class="sd">        stack_info: Call stack frames at time of invocation</span>
<span class="sd">        args: Positional arguments to the function</span>
<span class="sd">        kwargs: Original keyword arguments </span>
<span class="sd">        choice_kwargs: Final keyword arguments after rule processing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="o">=</span> <span class="n">impl</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack_info</span> <span class="o">=</span> <span class="n">stack_info</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span> <span class="o">=</span> <span class="n">choice_kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TraceItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceItem.print_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_item</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#pychoice.funcs.TraceItem.print_item" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print formatted representation of this trace item.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sb</code>
            </td>
            <td>
                  <code><span title="io.TextIOBase">TextIOBase</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text buffer to write output to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indent</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indentation level for nested display</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sb</span><span class="p">:</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print formatted representation of this trace item.</span>

<span class="sd">    Args:</span>
<span class="sd">        sb: Text buffer to write output to</span>
<span class="sd">        indent: Indentation level for nested display</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span>
    <span class="n">rule_str</span> <span class="o">=</span> <span class="s2">&quot; -&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;No rules&quot;</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">  Args: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s2">, Kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">, Choice Kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">  Rules: </span><span class="si">{</span><span class="n">rule_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sub_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="n">sub_item</span><span class="o">.</span><span class="n">print_item</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceItem.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#pychoice.funcs.TraceItem.to_dict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert trace item to dictionary representation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary representation suitable for JSON serialization</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert trace item to dictionary representation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary representation suitable for JSON serialization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;func&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
        <span class="s2">&quot;impl&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
        <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span>
        <span class="s2">&quot;stack_info&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">function</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">fi</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack_info</span><span class="p">],</span>
        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">],</span>
        <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="s2">&quot;choice_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">],</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.TraceStatus" class="doc doc-heading">
            <code>TraceStatus</code>


<a href="#pychoice.funcs.TraceStatus" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Global tracing state manager.</p>
<p>TraceStatus maintains the global state of tracing, allowing
trace collection to be started and stopped. It's used internally
by the trace_start() and trace_stop() functions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.TraceStatus.trace">trace</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Tracing (pychoice.funcs.Tracing)" href="#pychoice.funcs.Tracing">Tracing</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current active Tracing instance, or None if not tracing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TraceStatus</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Global tracing state manager.</span>

<span class="sd">    TraceStatus maintains the global state of tracing, allowing</span>
<span class="sd">    trace collection to be started and stopped. It&#39;s used internally</span>
<span class="sd">    by the trace_start() and trace_stop() functions.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        trace: Current active Tracing instance, or None if not tracing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span> <span class="n">Tracing</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">TraceItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record the beginning of a choice function call.</span>

<span class="sd">        Args:</span>
<span class="sd">            item: TraceItem representing the call being started</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record the end of a choice function call.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a new tracing session.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">Tracing</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop tracing and return collected trace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Trace object containing all collected choice function calls</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Tracing</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceStatus.call_begin" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_begin</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#pychoice.funcs.TraceStatus.call_begin" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Record the beginning of a choice function call.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>item</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TraceItem (pychoice.funcs.TraceItem)" href="#pychoice.funcs.TraceItem">TraceItem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TraceItem representing the call being started</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">call_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">TraceItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the beginning of a choice function call.</span>

<span class="sd">    Args:</span>
<span class="sd">        item: TraceItem representing the call being started</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceStatus.call_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_end</span><span class="p">()</span></code>

<a href="#pychoice.funcs.TraceStatus.call_end" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Record the end of a choice function call.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">call_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Record the end of a choice function call.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceStatus.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#pychoice.funcs.TraceStatus.start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start a new tracing session.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a new tracing session.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">Tracing</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.TraceStatus.stop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#pychoice.funcs.TraceStatus.stop" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop tracing and return collected trace.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Trace (pychoice.funcs.Trace)" href="#pychoice.funcs.Trace">Trace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trace object containing all collected choice function calls</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop tracing and return collected trace.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Trace object containing all collected choice function calls</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Tracing</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.funcs.Tracing" class="doc doc-heading">
            <code>Tracing</code>


<a href="#pychoice.funcs.Tracing" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Manages the collection of trace items during tracing.</p>
<p>Tracing maintains the active stack of TraceItems as choice functions
are called, building a hierarchical structure of invocations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.Tracing.items">items</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="TraceItem (pychoice.funcs.TraceItem)" href="#pychoice.funcs.TraceItem">TraceItem</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Completed top-level trace items</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.funcs.Tracing.stack">stack</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="TraceItem (pychoice.funcs.TraceItem)" href="#pychoice.funcs.TraceItem">TraceItem</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current stack of active trace items</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Tracing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages the collection of trace items during tracing.</span>

<span class="sd">    Tracing maintains the active stack of TraceItems as choice functions</span>
<span class="sd">    are called, building a hierarchical structure of invocations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        items: Completed top-level trace items</span>
<span class="sd">        stack: Current stack of active trace items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TraceItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TraceItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">TraceItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Begin tracing a new choice function call.</span>

<span class="sd">        Args:</span>
<span class="sd">            item: TraceItem for the function call being started</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;End tracing the most recent choice function call.</span>

<span class="sd">        Raises:</span>
<span class="sd">            MismatchedTrace: If there are no active calls to end</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MismatchedTrace</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ended</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Tracing.begin" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">begin</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#pychoice.funcs.Tracing.begin" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Begin tracing a new choice function call.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>item</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TraceItem (pychoice.funcs.TraceItem)" href="#pychoice.funcs.TraceItem">TraceItem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TraceItem for the function call being started</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">TraceItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Begin tracing a new choice function call.</span>

<span class="sd">    Args:</span>
<span class="sd">        item: TraceItem for the function call being started</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.funcs.Tracing.end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end</span><span class="p">()</span></code>

<a href="#pychoice.funcs.Tracing.end" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>End tracing the most recent choice function call.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MismatchedTrace (pychoice.funcs.MismatchedTrace)" href="#pychoice.funcs.MismatchedTrace">MismatchedTrace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there are no active calls to end</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;End tracing the most recent choice function call.</span>

<span class="sd">    Raises:</span>
<span class="sd">        MismatchedTrace: If there are no active calls to end</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MismatchedTrace</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ended</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.def_rule" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">def_rule</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span></code>

<a href="#pychoice.funcs.def_rule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator for creating dynamic rules with custom logic.</p>
<p>Unlike simple rules created with rule(), def_rule allows you to create
rules with custom logic that can dynamically determine parameter values
based on captured variables from the call stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selector</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL">SEL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List defining the call stack pattern to match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function for the rule implementation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.def_rule([debug_mode, log])
def debug_log_rule(captures):
    # Custom logic based on captured variables
    return None, {&quot;level&quot;: &quot;DEBUG&quot;, &quot;verbose&quot;: True}
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">def_rule</span><span class="p">(</span><span class="n">selector</span><span class="p">:</span> <span class="n">SEL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator for creating dynamic rules with custom logic.</span>

<span class="sd">    Unlike simple rules created with rule(), def_rule allows you to create</span>
<span class="sd">    rules with custom logic that can dynamically determine parameter values</span>
<span class="sd">    based on captured variables from the call stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        selector: List defining the call stack pattern to match</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function for the rule implementation</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.def_rule([debug_mode, log])</span>
<span class="sd">        def debug_log_rule(captures):</span>
<span class="sd">            # Custom logic based on captured variables</span>
<span class="sd">            return None, {&quot;level&quot;: &quot;DEBUG&quot;, &quot;verbose&quot;: True}</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">RuleVals</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RuleVals</span><span class="p">:</span>
        <span class="c1"># Choose function implementation</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="n">new_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
        <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">choice_function</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice_fun</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
            <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">,</span> <span class="n">choice_fun</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
        <span class="n">choice_fun</span><span class="o">.</span><span class="n">_add_rule</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.func" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.funcs.func" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to create a choice function from a regular function.</p>
<p>This is the primary decorator for creating choice functions. It converts
a regular function into a ChoiceFunction that can be customized through rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names that can be customized by rules</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]], <a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function that converts a function to a ChoiceFunction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func(args=[&quot;greeting&quot;, &quot;punctuation&quot;])
def greet(name: str, greeting=&quot;Hello&quot;, punctuation=&quot;!&quot;):
    return f&quot;{greeting} {name}{punctuation}&quot;
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]],</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create a choice function from a regular function.</span>

<span class="sd">    This is the primary decorator for creating choice functions. It converts</span>
<span class="sd">    a regular function into a ChoiceFunction that can be customized through rules.</span>

<span class="sd">    Args:</span>
<span class="sd">        args: List of parameter names that can be customized by rules</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function that converts a function to a ChoiceFunction</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func(args=[&quot;greeting&quot;, &quot;punctuation&quot;])</span>
<span class="sd">        def greet(name: str, greeting=&quot;Hello&quot;, punctuation=&quot;!&quot;):</span>
<span class="sd">            return f&quot;{greeting} {name}{punctuation}&quot;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
        <span class="n">func_args</span> <span class="o">=</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="c1"># Choice interface</span>

        <span class="c1"># Add to registry</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">func_args</span><span class="p">)</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>

        <span class="c1"># Return wrapper</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">reg</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.impl" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">impl</span><span class="p">(</span><span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.funcs.impl" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to create alternative implementations for choice functions.</p>
<p>This decorator creates alternative implementations that can be used by
rules to completely replace the behavior of a choice function in specific contexts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>implements</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction this will be an implementation for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names this implementation accepts</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]], <a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function that creates a ChoiceFuncImplementation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.impl(implements=greet, args=[&quot;greeting&quot;, &quot;title&quot;])
def formal_greet(name: str, greeting=&quot;Dear&quot;, title=&quot;&quot;):
    return f&quot;{greeting} {title} {name}&quot;
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">impl</span><span class="p">[</span><span class="n">O</span><span class="p">](</span>
    <span class="n">implements</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]],</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create alternative implementations for choice functions.</span>

<span class="sd">    This decorator creates alternative implementations that can be used by</span>
<span class="sd">    rules to completely replace the behavior of a choice function in specific contexts.</span>

<span class="sd">    Args:</span>
<span class="sd">        implements: The ChoiceFunction this will be an implementation for</span>
<span class="sd">        args: List of parameter names this implementation accepts</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function that creates a ChoiceFuncImplementation</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.impl(implements=greet, args=[&quot;greeting&quot;, &quot;title&quot;])</span>
<span class="sd">        def formal_greet(name: str, greeting=&quot;Dear&quot;, title=&quot;&quot;):</span>
<span class="sd">            return f&quot;{greeting} {title} {name}&quot;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
        <span class="n">func_args</span> <span class="o">=</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="c1"># Choice implementation</span>

        <span class="c1"># Add to registry</span>
        <span class="n">implements</span><span class="o">.</span><span class="n">_add_func</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">func_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">func_args</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.new_selector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new_selector</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#pychoice.funcs.new_selector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a Selector from a list of selector inputs.</p>
<p>Convenience function that converts a list of various selector inputs
into SelectorItems and creates a Selector.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>items</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL">SEL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selector inputs (functions, classes, etc.)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impl</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional implementation identifier string</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Selector instance with converted SelectorItems</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Create selector for my_app -&gt; greet call chain
selector = new_selector([my_app, greet])
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_selector</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">SEL</span><span class="p">,</span> <span class="n">impl</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Selector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Selector from a list of selector inputs.</span>

<span class="sd">    Convenience function that converts a list of various selector inputs</span>
<span class="sd">    into SelectorItems and creates a Selector.</span>

<span class="sd">    Args:</span>
<span class="sd">        items: List of selector inputs (functions, classes, etc.)</span>
<span class="sd">        impl: Optional implementation identifier string</span>

<span class="sd">    Returns:</span>
<span class="sd">        Selector instance with converted SelectorItems</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Create selector for my_app -&gt; greet call chain</span>
<span class="sd">        selector = new_selector([my_app, greet])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sel_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_selector_item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Selector</span><span class="p">(</span><span class="n">sel_items</span><span class="p">,</span> <span class="n">impl</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.new_selector_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new_selector_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#pychoice.funcs.new_selector_item" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a SelectorItem from various input types.</p>
<p>This factory function converts different types of selector inputs into
appropriate SelectorItem instances for use in Selectors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>item</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL_I">SEL_I</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input item to convert (function, class, tuple, etc.)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Appropriate SelectorItem subclass instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidSelectorItem (pychoice.selector.InvalidSelectorItem)" href="#pychoice.selector.InvalidSelectorItem">InvalidSelectorItem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input type cannot be converted</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Convert function to selector item
func_item = new_selector_item(my_function)

# Convert class method to selector item  
method_item = new_selector_item((MyClass, &quot;method_name&quot;))
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_selector_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">SEL_I</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelectorItem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a SelectorItem from various input types.</span>

<span class="sd">    This factory function converts different types of selector inputs into</span>
<span class="sd">    appropriate SelectorItem instances for use in Selectors.</span>

<span class="sd">    Args:</span>
<span class="sd">        item: Input item to convert (function, class, tuple, etc.)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Appropriate SelectorItem subclass instance</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidSelectorItem: If the input type cannot be converted</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Convert function to selector item</span>
<span class="sd">        func_item = new_selector_item(my_function)</span>

<span class="sd">        # Convert class method to selector item  </span>
<span class="sd">        method_item = new_selector_item((MyClass, &quot;method_name&quot;))</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ChoiceContext</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ChoiceContextSelectorItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ClassSelectorItem</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">SelectorItem</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;__code__&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FunctionSelectorItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">CallableSelectorItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidSelectorItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.rule" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">impl</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pychoice.funcs.rule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a choice rule that customizes function behavior in specific contexts.</p>
<p>Rules define when and how to customize choice functions. They specify a selector
(which determines when the rule applies) and either an alternative implementation
or parameter overrides.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selector</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL">SEL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List defining the call stack pattern to match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impl</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a> | <a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ChoiceFunction, ChoiceFuncImplementation, or None for parameter-only rules</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter values to apply when this rule matches</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Parameter-only rule
choice.rule([my_app, greet], greet, greeting=&quot;Hi&quot;)

# Implementation-switching rule
choice.rule([formal_context, greet], formal_greet_impl)
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule</span><span class="p">(</span><span class="n">selector</span><span class="p">:</span> <span class="n">SEL</span><span class="p">,</span> <span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFunction</span> <span class="o">|</span> <span class="n">ChoiceFuncImplementation</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a choice rule that customizes function behavior in specific contexts.</span>

<span class="sd">    Rules define when and how to customize choice functions. They specify a selector</span>
<span class="sd">    (which determines when the rule applies) and either an alternative implementation</span>
<span class="sd">    or parameter overrides.</span>

<span class="sd">    Args:</span>
<span class="sd">        selector: List defining the call stack pattern to match</span>
<span class="sd">        impl: ChoiceFunction, ChoiceFuncImplementation, or None for parameter-only rules</span>
<span class="sd">        **kwargs: Parameter values to apply when this rule matches</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Parameter-only rule</span>
<span class="sd">        choice.rule([my_app, greet], greet, greeting=&quot;Hi&quot;)</span>

<span class="sd">        # Implementation-switching rule</span>
<span class="sd">        choice.rule([formal_context, greet], formal_greet_impl)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">impl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Allow None implementation for args-only rules</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">interface</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">):</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="n">impl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NonRule</span><span class="p">()</span>
    <span class="c1"># Choose function implementation</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">new_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">processed_impl</span><span class="p">)</span> <span class="k">if</span> <span class="n">processed_impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">choice_function</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice_fun</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
        <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">,</span> <span class="n">choice_fun</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
    <span class="n">choice_fun</span><span class="o">.</span><span class="n">_add_rule</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">processed_impl</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="p">(</span><span class="n">processed_impl</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.funcs.wrap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wrap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.funcs.wrap" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert an existing function into a choice function implementation.</p>
<p>This is a non-decorator alternative to @impl for when you want to convert
an existing function into a choice implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>implements</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction this will implement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names this implementation accepts</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ChoiceFuncImplementation wrapping the provided function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">def existing_greet(name: str, style=&quot;casual&quot;):
    return f&quot;Hey {name}!&quot;

casual_impl = choice.wrap(existing_greet, greet, args=[&quot;style&quot;])
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wrap</span><span class="p">[</span><span class="n">O</span><span class="p">](</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="n">implements</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an existing function into a choice function implementation.</span>

<span class="sd">    This is a non-decorator alternative to @impl for when you want to convert</span>
<span class="sd">    an existing function into a choice implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        f: The function to convert</span>
<span class="sd">        implements: The ChoiceFunction this will implement</span>
<span class="sd">        args: List of parameter names this implementation accepts</span>

<span class="sd">    Returns:</span>
<span class="sd">        ChoiceFuncImplementation wrapping the provided function</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        def existing_greet(name: str, style=&quot;casual&quot;):</span>
<span class="sd">            return f&quot;Hey {name}!&quot;</span>

<span class="sd">        casual_impl = choice.wrap(existing_greet, greet, args=[&quot;style&quot;])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">impl</span><span class="p">(</span><span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="arguments-and-rules-module">Arguments and Rules Module<a class="headerlink" href="#arguments-and-rules-module" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pychoice.args"></a>
    <div class="doc doc-contents first">

        <p>Core argument handling and rule management for PyChoice.</p>
<p>This module contains the fundamental classes for defining and managing choice rules,
selectors, and implementations. It handles the logic for matching selectors against
call stacks and applying the appropriate implementations.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pychoice.args.ChoiceFuncImplementation" class="doc doc-heading">
            <code>ChoiceFuncImplementation</code>


<a href="#pychoice.args.ChoiceFuncImplementation" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Implementation wrapper for choice functions.</p>
<p>This class wraps a regular function to make it usable as a choice function
implementation, handling parameter validation, rule application, and invocation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.ChoiceFuncImplementation.id">id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for this implementation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.ChoiceFuncImplementation.func">func</span></code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wrapped function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.ChoiceFuncImplementation.defaults">defaults</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default parameter values from the function signature</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Create an implementation for a greeting function
impl = ChoiceFuncImplementation([&quot;greeting&quot;], greet_func)
result = impl(matched_rules, (&quot;John&quot;,), {})
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation wrapper for choice functions.</span>

<span class="sd">    This class wraps a regular function to make it usable as a choice function</span>
<span class="sd">    implementation, handling parameter validation, rule application, and invocation.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        id: Unique identifier for this implementation</span>
<span class="sd">        func: The wrapped function</span>
<span class="sd">        defaults: Default parameter values from the function signature</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Create an implementation for a greeting function</span>
<span class="sd">        impl = ChoiceFuncImplementation([&quot;greeting&quot;], greet_func)</span>
<span class="sd">        result = impl(matched_rules, (&quot;John&quot;,), {})</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a choice function implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            choice_args: List of parameter names that can be customized by rules</span>
<span class="sd">            func: The function to wrap as a choice implementation</span>

<span class="sd">        Raises:</span>
<span class="sd">            MissingChoiceArg: If any choice_arg is not a parameter of func</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">uuid5</span><span class="p">(</span><span class="n">UUID_NAMESPACE</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

        <span class="c1"># Collect args</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">:</span>
                <span class="n">defaults</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span>

        <span class="c1"># Validate args</span>
        <span class="k">for</span> <span class="n">choice_arg</span> <span class="ow">in</span> <span class="n">choice_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">choice_arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">MissingChoiceArg</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">choice_arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="n">defaults</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">choice_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge rule values with provided kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            rules: List of matched rules to apply</span>
<span class="sd">            args: Positional arguments (unused but kept for consistency)</span>
<span class="sd">            kwargs: Keyword arguments from the call</span>

<span class="sd">        Returns:</span>
<span class="sd">            Merged dictionary of keyword arguments with rule values applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
            <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span>
        <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">O</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the implementation with rule-modified parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            rules: List of matched rules to apply</span>
<span class="sd">            args: Positional arguments to pass to the function</span>
<span class="sd">            kwargs: Keyword arguments to pass to the function</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result of calling the wrapped function with modified parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.args.ChoiceFuncImplementation.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pychoice.args.ChoiceFuncImplementation.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Execute the implementation with rule-modified parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="MatchedRule (pychoice.args.MatchedRule)" href="#pychoice.args.MatchedRule">MatchedRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of matched rules to apply</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="typing.Any">Any</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments to pass to the function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="O">O</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of calling the wrapped function with modified parameters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">O</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the implementation with rule-modified parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        rules: List of matched rules to apply</span>
<span class="sd">        args: Positional arguments to pass to the function</span>
<span class="sd">        kwargs: Keyword arguments to pass to the function</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result of calling the wrapped function with modified parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">choice_kwargs</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.ChoiceFuncImplementation.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">choice_args</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></code>

<a href="#pychoice.args.ChoiceFuncImplementation.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize a choice function implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>choice_args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names that can be customized by rules</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="pychoice.args.F">F</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to wrap as a choice implementation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MissingChoiceArg (pychoice.args.MissingChoiceArg)" href="#pychoice.args.MissingChoiceArg">MissingChoiceArg</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any choice_arg is not a parameter of func</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a choice function implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        choice_args: List of parameter names that can be customized by rules</span>
<span class="sd">        func: The function to wrap as a choice implementation</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingChoiceArg: If any choice_arg is not a parameter of func</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">uuid5</span><span class="p">(</span><span class="n">UUID_NAMESPACE</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="c1"># Collect args</span>
    <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">:</span>
            <span class="n">defaults</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span>

    <span class="c1"># Validate args</span>
    <span class="k">for</span> <span class="n">choice_arg</span> <span class="ow">in</span> <span class="n">choice_args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">choice_arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingChoiceArg</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">choice_arg</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="n">defaults</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.ChoiceFuncImplementation.choice_kwargs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">choice_kwargs</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pychoice.args.ChoiceFuncImplementation.choice_kwargs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Merge rule values with provided kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="MatchedRule (pychoice.args.MatchedRule)" href="#pychoice.args.MatchedRule">MatchedRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of matched rules to apply</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="typing.Any">Any</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments (unused but kept for consistency)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments from the call</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Merged dictionary of keyword arguments with rule values applied</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choice_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MatchedRule</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge rule values with provided kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        rules: List of matched rules to apply</span>
<span class="sd">        args: Positional arguments (unused but kept for consistency)</span>
<span class="sd">        kwargs: Keyword arguments from the call</span>

<span class="sd">    Returns:</span>
<span class="sd">        Merged dictionary of keyword arguments with rule values applied</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">new_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.args.MatchedRule" class="doc doc-heading">
            <code>MatchedRule</code>


<a href="#pychoice.args.MatchedRule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Represents a rule that has been matched against a call stack.</p>
<p>When a Selector matches a call stack, it creates a MatchedRule containing
the original rule, captured variables, and resolved implementation details.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.MatchedRule.rule">rule</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original Rule that was matched</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.MatchedRule.captures">captures</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable dictionaries captured from matching stack frames</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.MatchedRule.impl">impl</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resolved ChoiceFuncImplementation to use</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.MatchedRule.vals">vals</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resolved parameter values to apply</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># When a rule matches, it becomes a MatchedRule
matched = MatchedRule(rule, captured_vars)
# matched.impl contains the implementation to use
# matched.vals contains the parameter overrides
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MatchedRule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a rule that has been matched against a call stack.</span>

<span class="sd">    When a Selector matches a call stack, it creates a MatchedRule containing</span>
<span class="sd">    the original rule, captured variables, and resolved implementation details.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        rule: The original Rule that was matched</span>
<span class="sd">        captures: List of variable dictionaries captured from matching stack frames</span>
<span class="sd">        impl: The resolved ChoiceFuncImplementation to use</span>
<span class="sd">        vals: The resolved parameter values to apply</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # When a rule matches, it becomes a MatchedRule</span>
<span class="sd">        matched = MatchedRule(rule, captured_vars)</span>
<span class="sd">        # matched.impl contains the implementation to use</span>
<span class="sd">        # matched.vals contains the parameter overrides</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">captures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rule</span> <span class="o">=</span> <span class="n">Rule</span><span class="p">(</span><span class="n">Selector</span><span class="p">([]),</span> <span class="kc">None</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">captures</span> <span class="o">=</span> <span class="n">captures</span>

        <span class="n">vals</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">vals</span><span class="p">(</span><span class="n">captures</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.args.MissingChoiceArg" class="doc doc-heading">
            <code>MissingChoiceArg</code>


<a href="#pychoice.args.MissingChoiceArg" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when a choice function is missing expected arguments.</p>
<p>This occurs when a @choice.func decorator specifies choice arguments that
don't exist as parameters in the decorated function.</p>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func(args=[&quot;nonexistent&quot;])  # This arg doesn't exist
def greet(name: str):  # Missing &quot;nonexistent&quot; parameter
    return f&quot;Hello {name}&quot;
# Raises MissingChoiceArg
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MissingChoiceArg</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a choice function is missing expected arguments.</span>

<span class="sd">    This occurs when a @choice.func decorator specifies choice arguments that</span>
<span class="sd">    don&#39;t exist as parameters in the decorated function.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func(args=[&quot;nonexistent&quot;])  # This arg doesn&#39;t exist</span>
<span class="sd">        def greet(name: str):  # Missing &quot;nonexistent&quot; parameter</span>
<span class="sd">            return f&quot;Hello {name}&quot;</span>
<span class="sd">        # Raises MissingChoiceArg</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">choice_arg</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;The function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is missing the expected choice kwarg </span><span class="si">{</span><span class="n">choice_arg</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.args.Rule" class="doc doc-heading">
            <code>Rule</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#pychoice.args.Rule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Represents a choice rule that defines when and how to customize function behavior.</p>
<p>A Rule combines a Selector (which defines when the rule applies) with an 
implementation and values (which define how to customize the behavior).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Rule.selector">selector</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Selector that determines when this rule matches</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Rule.impl">impl</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFuncImplementation to use, or None for parameter-only rules</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Rule.vals">vals</span></code></td>
            <td>
                  <code><span title="RuleVals">RuleVals</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that converts captures to implementation and values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Rule.doc">doc</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional documentation string for the rule</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Rule that changes greeting in my_app context
rule = Rule(
    selector=Selector([my_app, greet]),
    impl=greet_impl,
    vals=lambda c: (greet_impl, {&quot;greeting&quot;: &quot;Hi&quot;})
)
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Rule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a choice rule that defines when and how to customize function behavior.</span>

<span class="sd">    A Rule combines a Selector (which defines when the rule applies) with an </span>
<span class="sd">    implementation and values (which define how to customize the behavior).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        selector: The Selector that determines when this rule matches</span>
<span class="sd">        impl: The ChoiceFuncImplementation to use, or None for parameter-only rules</span>
<span class="sd">        vals: Function that converts captures to implementation and values</span>
<span class="sd">        doc: Optional documentation string for the rule</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Rule that changes greeting in my_app context</span>
<span class="sd">        rule = Rule(</span>
<span class="sd">            selector=Selector([my_app, greet]),</span>
<span class="sd">            impl=greet_impl,</span>
<span class="sd">            vals=lambda c: (greet_impl, {&quot;greeting&quot;: &quot;Hi&quot;})</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">selector</span><span class="p">:</span> <span class="n">Selector</span>
    <span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFuncImplementation</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">RuleVals</span>
    <span class="n">doc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.args.Selector" class="doc doc-heading">
            <code>Selector</code>


<a href="#pychoice.args.Selector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Defines a pattern for matching against function call stacks.</p>
<p>A Selector contains a list of SelectorItems that must match in order
from the deepest to shallowest call stack frames. It's used to determine
when choice rules should be applied.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Selector.items">items</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SelectorItems that define the matching pattern</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.args.Selector.impl">impl</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Implementation identifier string for display purposes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Match when greet() is called from my_app()
selector = Selector([my_app, greet])
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Selector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines a pattern for matching against function call stacks.</span>

<span class="sd">    A Selector contains a list of SelectorItems that must match in order</span>
<span class="sd">    from the deepest to shallowest call stack frames. It&#39;s used to determine</span>
<span class="sd">    when choice rules should be applied.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        items: List of SelectorItems that define the matching pattern</span>
<span class="sd">        impl: Implementation identifier string for display purposes</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Match when greet() is called from my_app()</span>
<span class="sd">        selector = Selector([my_app, greet])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SelectorItem</span><span class="p">],</span> <span class="n">impl</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SelectorItem</span><span class="p">]</span> <span class="o">=</span> <span class="n">items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">impl</span> <span class="o">=</span> <span class="n">impl</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">impl</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">choice_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the choice function that this selector targets.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The callable from the last SelectorItem, typically a choice function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort selectors by specificity, returning indices.</span>

<span class="sd">        Returns indices of selectors sorted from least specific (0) to most </span>
<span class="sd">        specific (-1). Non-matching selectors are excluded.</span>

<span class="sd">        Args:</span>
<span class="sd">            selectors: List of selectors to sort</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of indices in specificity order (most specific last)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selectors</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

        <span class="c1"># Get indices and filter to only matching</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">matches</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Selector</span><span class="o">.</span><span class="n">all_matches</span><span class="p">(</span><span class="n">selectors</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">))</span> <span class="k">if</span> <span class="n">matches</span><span class="p">]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">selectors</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">selectors</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">stack_info</span><span class="p">)</span>

        <span class="c1"># Sort</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="n">compare</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_matches</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">],</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">OptStackFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check which selectors match the current call stack.</span>

<span class="sd">        Args:</span>
<span class="sd">            selectors: List of selectors to check</span>
<span class="sd">            stack_info: Optional stack frames, uses current stack if None</span>

<span class="sd">        Returns:</span>
<span class="sd">            Boolean list indicating which selectors match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selectors</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">stack_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">stack_info</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">selector</span> <span class="ow">in</span> <span class="n">selectors</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">OptStackFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatchedRule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this selector matches the given call stack.</span>

<span class="sd">        Args:</span>
<span class="sd">            stack_info: Stack frames to match against, uses current if None</span>
<span class="sd">            rule: Associated rule for creating MatchedRule</span>

<span class="sd">        Returns:</span>
<span class="sd">            MatchedRule if selector matches, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stack_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Empty selector always matches</span>
            <span class="k">return</span> <span class="n">MatchedRule</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">captures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="n">stack_info</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
                <span class="n">captures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">selector_index</span><span class="p">],</span> <span class="n">frame_info</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">selector_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">MatchedRule</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">captures</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># More selector components</span>
                    <span class="n">selector_index</span> <span class="o">=</span> <span class="n">selector_index</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_collect_captures</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">SelectorItem</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Collect variable captures from a matching stack frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            item: The SelectorItem that matched</span>
<span class="sd">            frame_info: The stack frame that was matched</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of captured local variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Import Match here to avoid circular imports</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.funcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallableSelectorItem</span><span class="p">,</span> <span class="n">ChoiceFunction</span>

        <span class="c1"># Capture logic moved from Match.capture</span>
        <span class="n">local_vars</span> <span class="o">=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span>

        <span class="c1"># Check if we&#39;re in a ChoiceFunction.__call__ context</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">CallableSelectorItem</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
            <span class="n">choice_func</span> <span class="o">=</span> <span class="n">local_vars</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">]</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">local_vars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="p">())</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">local_vars</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kwargs&quot;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="c1"># Get the signature of the actual function</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">choice_func</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>

            <span class="c1"># Bind the arguments to get the actual parameter values</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bound_args</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">bound_args</span><span class="o">.</span><span class="n">apply_defaults</span><span class="p">()</span>

                <span class="c1"># Return only the requested match_args</span>
                <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bound_args</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># noqa: S110</span>
                <span class="c1"># Fall back to original behavior if binding fails</span>
                <span class="k">pass</span>

        <span class="c1"># Original behavior for regular functions</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">local_vars</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Selector</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">StackFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare selector specificity for a given call stack.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Other selector to compare against</span>
<span class="sd">            stack_info: Call stack to compare within</span>

<span class="sd">        Returns:</span>
<span class="sd">            -1 if self is less specific, 1 if more specific, 0 if equal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span>
        <span class="n">a_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">b_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="n">stack_info</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">a_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">b_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="n">a_matches</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">a_selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>
            <span class="n">b_matches</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">b_selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">b_matches</span><span class="p">:</span>
                <span class="c1"># Check next frame</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="n">b_matches</span><span class="p">:</span>
                <span class="n">a_selector_index</span> <span class="o">=</span> <span class="n">a_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">b_selector_index</span> <span class="o">=</span> <span class="n">b_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="n">b_matches</span><span class="p">:</span>
                <span class="c1"># b has lower level match, takes precedence</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">elif</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">b_matches</span><span class="p">:</span>
                <span class="c1"># a has lower level match, takes precedence</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generic_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Selector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare selectors generically without specific call stack context.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Other selector to compare against</span>

<span class="sd">        Returns:</span>
<span class="sd">            -1 if self is sub-selector of other, 1 if other is sub-selector of self, 0 if no relation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span>
        <span class="n">a_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">b_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">a_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">a_selector_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">b_selector_index</span><span class="p">]:</span>
                <span class="n">a_selector_index</span> <span class="o">=</span> <span class="n">a_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">b_selector_index</span> <span class="o">=</span> <span class="n">b_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Term mismatch. No sub_selector relation</span>
                <span class="k">return</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">a_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">b_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="c1"># Selectors are equal</span>
        <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.all_matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_matches</span><span class="p">(</span><span class="n">selectors</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#pychoice.args.Selector.all_matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check which selectors match the current call stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selectors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selectors to check</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stack_info</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.OptStackFrame">OptStackFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional stack frames, uses current stack if None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean list indicating which selectors match</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">all_matches</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">],</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">OptStackFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check which selectors match the current call stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        selectors: List of selectors to check</span>
<span class="sd">        stack_info: Optional stack frames, uses current stack if None</span>

<span class="sd">    Returns:</span>
<span class="sd">        Boolean list indicating which selectors match</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">selectors</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">stack_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">stack_info</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">selector</span> <span class="ow">in</span> <span class="n">selectors</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.choice_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">choice_function</span><span class="p">()</span></code>

<a href="#pychoice.args.Selector.choice_function" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the choice function that this selector targets.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable from the last SelectorItem, typically a choice function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choice_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the choice function that this selector targets.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The callable from the last SelectorItem, typically a choice function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.compare" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span></code>

<a href="#pychoice.args.Selector.compare" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compare selector specificity for a given call stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Other selector to compare against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stack_info</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.StackFrame">StackFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Call stack to compare within</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>-1 if self is less specific, 1 if more specific, 0 if equal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Selector</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">StackFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare selector specificity for a given call stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Other selector to compare against</span>
<span class="sd">        stack_info: Call stack to compare within</span>

<span class="sd">    Returns:</span>
<span class="sd">        -1 if self is less specific, 1 if more specific, 0 if equal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span>
    <span class="n">a_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">b_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="n">stack_info</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">a_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">b_selector_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">a_matches</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">a_selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>
        <span class="n">b_matches</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">b_selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">b_matches</span><span class="p">:</span>
            <span class="c1"># Check next frame</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="n">b_matches</span><span class="p">:</span>
            <span class="n">a_selector_index</span> <span class="o">=</span> <span class="n">a_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">b_selector_index</span> <span class="o">=</span> <span class="n">b_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="n">b_matches</span><span class="p">:</span>
            <span class="c1"># b has lower level match, takes precedence</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">a_matches</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">b_matches</span><span class="p">:</span>
            <span class="c1"># a has lower level match, takes precedence</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.generic_compare" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generic_compare</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#pychoice.args.Selector.generic_compare" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compare selectors generically without specific call stack context.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Other selector to compare against</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>-1 if self is sub-selector of other, 1 if other is sub-selector of self, 0 if no relation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generic_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Selector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare selectors generically without specific call stack context.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Other selector to compare against</span>

<span class="sd">    Returns:</span>
<span class="sd">        -1 if self is sub-selector of other, 1 if other is sub-selector of self, 0 if no relation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span>
    <span class="n">a_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">b_selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">a_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">a_selector_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">b_selector_index</span><span class="p">]:</span>
            <span class="n">a_selector_index</span> <span class="o">=</span> <span class="n">a_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">b_selector_index</span> <span class="o">=</span> <span class="n">b_selector_index</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Term mismatch. No sub_selector relation</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">a_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">b_selector_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="c1"># Selectors are equal</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">stack_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.args.Selector.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if this selector matches the given call stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stack_info</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.OptStackFrame">OptStackFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frames to match against, uses current if None</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Rule


  
      dataclass
   (pychoice.args.Rule)" href="#pychoice.args.Rule">Rule</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Associated rule for creating MatchedRule</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MatchedRule (pychoice.args.MatchedRule)" href="#pychoice.args.MatchedRule">MatchedRule</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MatchedRule if selector matches, None otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">OptStackFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">Rule</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MatchedRule</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this selector matches the given call stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        stack_info: Stack frames to match against, uses current if None</span>
<span class="sd">        rule: Associated rule for creating MatchedRule</span>

<span class="sd">    Returns:</span>
<span class="sd">        MatchedRule if selector matches, None otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">stack_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Empty selector always matches</span>
        <span class="k">return</span> <span class="n">MatchedRule</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">captures</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">selector_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="n">stack_info</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">selector_index</span><span class="p">]</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
            <span class="n">captures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">selector_index</span><span class="p">],</span> <span class="n">frame_info</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">selector_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">MatchedRule</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">captures</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># More selector components</span>
                <span class="n">selector_index</span> <span class="o">=</span> <span class="n">selector_index</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.args.Selector.sort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort</span><span class="p">(</span><span class="n">selectors</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#pychoice.args.Selector.sort" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sort selectors by specificity, returning indices.</p>
<p>Returns indices of selectors sorted from least specific (0) to most 
specific (-1). Non-matching selectors are excluded.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selectors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selectors to sort</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of indices in specificity order (most specific last)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/args.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort selectors by specificity, returning indices.</span>

<span class="sd">    Returns indices of selectors sorted from least specific (0) to most </span>
<span class="sd">    specific (-1). Non-matching selectors are excluded.</span>

<span class="sd">    Args:</span>
<span class="sd">        selectors: List of selectors to sort</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of indices in specificity order (most specific last)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">selectors</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="n">stack_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

    <span class="c1"># Get indices and filter to only matching</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">matches</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Selector</span><span class="o">.</span><span class="n">all_matches</span><span class="p">(</span><span class="n">selectors</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">))</span> <span class="k">if</span> <span class="n">matches</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compare</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">selectors</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">selectors</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="c1"># Sort</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="n">compare</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="selector-classes-module">Selector Classes Module<a class="headerlink" href="#selector-classes-module" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pychoice.selector"></a>
    <div class="doc doc-contents first">

        <p>Selector system for PyChoice - matching patterns against call stacks.</p>
<p>This module provides the selector system used by PyChoice to match patterns
against function call stacks. It includes various types of selector items
that can match different kinds of callables (functions, methods, contexts)
and the infrastructure for managing choice contexts.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.CallableSelectorItem" class="doc doc-heading">
            <code>CallableSelectorItem</code>


<a href="#pychoice.selector.CallableSelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Selector item that matches callable objects (including choice functions).</p>
<p>This selector handles callable objects that may not be simple functions,
such as choice functions, lambdas, or objects with <strong>call</strong> methods.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.CallableSelectorItem.func">func</span></code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable object to match against</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func()
def my_choice_func():
    pass

callable_selector = CallableSelectorItem(my_choice_func)
# Matches stack frames executing the choice function
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CallableSelectorItem</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector item that matches callable objects (including choice functions).</span>

<span class="sd">    This selector handles callable objects that may not be simple functions,</span>
<span class="sd">    such as choice functions, lambdas, or objects with __call__ methods.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        func: The callable object to match against</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func()</span>
<span class="sd">        def my_choice_func():</span>
<span class="sd">            pass</span>

<span class="sd">        callable_selector = CallableSelectorItem(my_choice_func)</span>
<span class="sd">        # Matches stack frames executing the choice function</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a callable to match.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The callable object that this selector should match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">CallableSelectorItem</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the callable this selector represents.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this callable.</span>

<span class="sd">        This method handles the complexity of matching callable objects,</span>
<span class="sd">        including checking code objects and instance matching for methods.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the frame is executing this callable, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="fm">__call__</span><span class="p">,</span> <span class="s2">&quot;__code__&quot;</span><span class="p">):</span>  <span class="c1"># type: ignore[operator]</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="fm">__call__</span><span class="o">.</span><span class="vm">__code__</span> <span class="o">!=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__class__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">!=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.CallableSelectorItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#pychoice.selector.CallableSelectorItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize with a callable to match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable object that this selector should match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with a callable to match.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The callable object that this selector should match</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.CallableSelectorItem.get_callable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_callable</span><span class="p">()</span></code>

<a href="#pychoice.selector.CallableSelectorItem.get_callable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the callable this selector represents.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the callable this selector represents.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.CallableSelectorItem.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.selector.CallableSelectorItem.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the stack frame is executing this callable.</p>
<p>This method handles the complexity of matching callable objects,
including checking code objects and instance matching for methods.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the frame is executing this callable, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this callable.</span>

<span class="sd">    This method handles the complexity of matching callable objects,</span>
<span class="sd">    including checking code objects and instance matching for methods.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the frame is executing this callable, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="fm">__call__</span><span class="p">,</span> <span class="s2">&quot;__code__&quot;</span><span class="p">):</span>  <span class="c1"># type: ignore[operator]</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="fm">__call__</span><span class="o">.</span><span class="vm">__code__</span> <span class="o">!=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__class__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">!=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.ChoiceContext" class="doc doc-heading">
            <code>ChoiceContext</code>


<a href="#pychoice.selector.ChoiceContext" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Base class for choice contexts that provide temporary rule scoping.</p>
<p>ChoiceContexts allow you to create temporary scopes where specific choice
rules apply. They use Python's context manager protocol and context variables
to track when they are active.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.ChoiceContext.active">active</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ContextVar tracking whether this context is currently active</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">class DebugContext(ChoiceContext):
    pass

with DebugContext():
    # Rules targeting DebugContext will apply here
    my_function()  # May use different implementation
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for choice contexts that provide temporary rule scoping.</span>

<span class="sd">    ChoiceContexts allow you to create temporary scopes where specific choice</span>
<span class="sd">    rules apply. They use Python&#39;s context manager protocol and context variables</span>
<span class="sd">    to track when they are active.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        active: ContextVar tracking whether this context is currently active</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class DebugContext(ChoiceContext):</span>
<span class="sd">            pass</span>

<span class="sd">        with DebugContext():</span>
<span class="sd">            # Rules targeting DebugContext will apply here</span>
<span class="sd">            my_function()  # May use different implementation</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">ContextVar</span><span class="p">(</span><span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">TracebackType</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.ChoiceContextSelectorItem" class="doc doc-heading">
            <code>ChoiceContextSelectorItem</code>


<a href="#pychoice.selector.ChoiceContextSelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Selector item that matches when a specific ChoiceContext is active.</p>
<p>This selector matches stack frames that occur while a particular
ChoiceContext is active (i.e., within its context manager scope).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.ChoiceContextSelectorItem.context">context</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceContext class to check for activity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">class DebugContext(ChoiceContext):
    pass

debug_selector = ChoiceContextSelectorItem(DebugContext)
# Matches when code runs within &quot;with DebugContext():&quot; blocks
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceContextSelectorItem</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector item that matches when a specific ChoiceContext is active.</span>

<span class="sd">    This selector matches stack frames that occur while a particular</span>
<span class="sd">    ChoiceContext is active (i.e., within its context manager scope).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        context: The ChoiceContext class to check for activity</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class DebugContext(ChoiceContext):</span>
<span class="sd">            pass</span>

<span class="sd">        debug_selector = ChoiceContextSelectorItem(DebugContext)</span>
<span class="sd">        # Matches when code runs within &quot;with DebugContext():&quot; blocks</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">ChoiceContext</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a ChoiceContext class to match.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: The ChoiceContext class that must be active for matching</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ChoiceContext(active=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ChoiceContextSelectorItem</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">context</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the context is currently active.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame (unused for context matching)</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the ChoiceContext is currently active, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.ChoiceContextSelectorItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

<a href="#pychoice.selector.ChoiceContextSelectorItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize with a ChoiceContext class to match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="ChoiceContext (pychoice.selector.ChoiceContext)" href="#pychoice.selector.ChoiceContext">ChoiceContext</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceContext class that must be active for matching</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">ChoiceContext</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with a ChoiceContext class to match.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: The ChoiceContext class that must be active for matching</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.ChoiceContextSelectorItem.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.selector.ChoiceContextSelectorItem.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the context is currently active.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame (unused for context matching)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the ChoiceContext is currently active, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the context is currently active.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame (unused for context matching)</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the ChoiceContext is currently active, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.ClassSelectorItem" class="doc doc-heading">
            <code>ClassSelectorItem</code>


<a href="#pychoice.selector.ClassSelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Selector item that matches specific class methods.</p>
<p>This selector matches stack frames where a specific method of a specific
class (or its subclasses) is being executed. It supports inheritance
matching.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.ClassSelectorItem.cls">cls</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class to match</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.ClassSelectorItem.qual_name">qual_name</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Qualified name string (ClassName.method_name)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.ClassSelectorItem.func_name">func_name</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the method to match</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">class MyClass:
    def my_method(self):
        pass

class_selector = ClassSelectorItem(MyClass, &quot;my_method&quot;)
# Matches when MyClass.my_method or subclass.my_method is executing
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ClassSelectorItem</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector item that matches specific class methods.</span>

<span class="sd">    This selector matches stack frames where a specific method of a specific</span>
<span class="sd">    class (or its subclasses) is being executed. It supports inheritance</span>
<span class="sd">    matching.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        cls: The class to match</span>
<span class="sd">        qual_name: Qualified name string (ClassName.method_name)</span>
<span class="sd">        func_name: Name of the method to match</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class MyClass:</span>
<span class="sd">            def my_method(self):</span>
<span class="sd">                pass</span>

<span class="sd">        class_selector = ClassSelectorItem(MyClass, &quot;my_method&quot;)</span>
<span class="sd">        # Matches when MyClass.my_method or subclass.my_method is executing</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">func_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a class and method name to match.</span>

<span class="sd">        Args:</span>
<span class="sd">            cls: The class that must contain the method</span>
<span class="sd">            func_name: Name of the method to match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qual_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">qual_name</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ClassSelectorItem</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cls</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">func_name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">func_name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this class method.</span>

<span class="sd">        This method checks both the method name and class hierarchy,</span>
<span class="sd">        supporting inheritance matching where subclass methods match</span>
<span class="sd">        their parent class selectors.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if frame is executing this class method or a subclass override</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">func_name</span><span class="p">:</span>
            <span class="n">qualname</span> <span class="o">=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_qualname</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">qualname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">class_name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
                <span class="bp">cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="bp">cls</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.ClassSelectorItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">func_name</span><span class="p">)</span></code>

<a href="#pychoice.selector.ClassSelectorItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize with a class and method name to match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cls</code>
            </td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The class that must contain the method</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the method to match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">func_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with a class and method name to match.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls: The class that must contain the method</span>
<span class="sd">        func_name: Name of the method to match</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">=</span> <span class="bp">cls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">qual_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func_name</span> <span class="o">=</span> <span class="n">func_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.ClassSelectorItem.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.selector.ClassSelectorItem.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the stack frame is executing this class method.</p>
<p>This method checks both the method name and class hierarchy,
supporting inheritance matching where subclass methods match
their parent class selectors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if frame is executing this class method or a subclass override</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this class method.</span>

<span class="sd">    This method checks both the method name and class hierarchy,</span>
<span class="sd">    supporting inheritance matching where subclass methods match</span>
<span class="sd">    their parent class selectors.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if frame is executing this class method or a subclass override</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">func_name</span><span class="p">:</span>
        <span class="n">qualname</span> <span class="o">=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_qualname</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">qualname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">module</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
            <span class="bp">cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="bp">cls</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.FunctionSelectorItem" class="doc doc-heading">
            <code>FunctionSelectorItem</code>


<a href="#pychoice.selector.FunctionSelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Selector item that matches specific function calls.</p>
<p>This selector matches stack frames where the executing code corresponds
to a specific function object, based on code object comparison.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.selector.FunctionSelectorItem.func">func</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to match against</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">def my_function():
    pass

func_selector = FunctionSelectorItem(my_function)
# Matches stack frames executing my_function
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FunctionSelectorItem</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector item that matches specific function calls.</span>

<span class="sd">    This selector matches stack frames where the executing code corresponds</span>
<span class="sd">    to a specific function object, based on code object comparison.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        func: The function to match against</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        def my_function():</span>
<span class="sd">            pass</span>

<span class="sd">        func_selector = FunctionSelectorItem(my_function)</span>
<span class="sd">        # Matches stack frames executing my_function</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a function to match.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The function that this selector should match</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">FunctionSelectorItem</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the function this selector represents.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this function.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the frame is executing this function, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__code__</span> <span class="o">==</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.FunctionSelectorItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#pychoice.selector.FunctionSelectorItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize with a function to match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function that this selector should match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with a function to match.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function that this selector should match</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.FunctionSelectorItem.get_callable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_callable</span><span class="p">()</span></code>

<a href="#pychoice.selector.FunctionSelectorItem.get_callable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the function this selector represents.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the function this selector represents.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.FunctionSelectorItem.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.selector.FunctionSelectorItem.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the stack frame is executing this function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the frame is executing this function, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the stack frame is executing this function.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the frame is executing this function, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__code__</span> <span class="o">==</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_code</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.InvalidSelectorItem" class="doc doc-heading">
            <code>InvalidSelectorItem</code>


<a href="#pychoice.selector.InvalidSelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="TypeError">TypeError</span></code></p>


        <p>Exception raised when an invalid type is used as a selector item.</p>
<p>This occurs when trying to create a SelectorItem from an object type
that isn't supported by the selector system.</p>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># This would raise InvalidSelectorItem
selector = Selector([my_func, 42])  # 42 is not a valid selector item
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">InvalidSelectorItem</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an invalid type is used as a selector item.</span>

<span class="sd">    This occurs when trying to create a SelectorItem from an object type</span>
<span class="sd">    that isn&#39;t supported by the selector system.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # This would raise InvalidSelectorItem</span>
<span class="sd">        selector = Selector([my_func, 42])  # 42 is not a valid selector item</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">SEL_I</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the exception with information about the invalid item.</span>

<span class="sd">        Args:</span>
<span class="sd">            item: The invalid selector item that caused the error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid selector item type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.InvalidSelectorItem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#pychoice.selector.InvalidSelectorItem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the exception with information about the invalid item.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>item</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL_I">SEL_I</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The invalid selector item that caused the error</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">SEL_I</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the exception with information about the invalid item.</span>

<span class="sd">    Args:</span>
<span class="sd">        item: The invalid selector item that caused the error</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid selector item type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.NonFunction" class="doc doc-heading">
            <code>NonFunction</code>


<a href="#pychoice.selector.NonFunction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="TypeError">TypeError</span></code></p>


        <p>Exception raised when a non-function is used as final selector term.</p>
<p>The final term in a selector must be a callable (typically a choice function)
since it represents the target of the rule. This exception is raised when
the final term is not callable.</p>







              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NonFunction</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a non-function is used as final selector term.</span>

<span class="sd">    The final term in a selector must be a callable (typically a choice function)</span>
<span class="sd">    since it represents the target of the rule. This exception is raised when</span>
<span class="sd">    the final term is not callable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Expected a choice function for the final term in a selector&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.selector.SelectorItem" class="doc doc-heading">
            <code>SelectorItem</code>


<a href="#pychoice.selector.SelectorItem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Abstract base class for items that can be used in choice selectors.</p>
<p>SelectorItems define different ways to match against stack frames in
choice function call stacks. Each type of SelectorItem implements
different matching logic for various callable types.</p>
<p>This is an abstract base class - use concrete subclasses like
FunctionSelectorItem, ClassSelectorItem, or ChoiceContextSelectorItem.</p>







              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SelectorItem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for items that can be used in choice selectors.</span>

<span class="sd">    SelectorItems define different ways to match against stack frames in</span>
<span class="sd">    choice function call stacks. Each type of SelectorItem implements</span>
<span class="sd">    different matching logic for various callable types.</span>

<span class="sd">    This is an abstract base class - use concrete subclasses like</span>
<span class="sd">    FunctionSelectorItem, ClassSelectorItem, or ChoiceContextSelectorItem.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the callable object this selector item represents.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The callable object, or None if this item doesn&#39;t represent a callable</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: Must be implemented by subclasses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this selector item matches a stack frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check for matching</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this selector item matches the frame, False otherwise</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: Must be implemented by subclasses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.SelectorItem.get_callable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_callable</span><span class="p">()</span></code>

<a href="#pychoice.selector.SelectorItem.get_callable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the callable object this selector item represents.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable object, or None if this item doesn't represent a callable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Must be implemented by subclasses</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the callable object this selector item represents.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The callable object, or None if this item doesn&#39;t represent a callable</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Must be implemented by subclasses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.selector.SelectorItem.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.selector.SelectorItem.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if this selector item matches a stack frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check for matching</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if this selector item matches the frame, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Must be implemented by subclasses</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/selector.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this selector item matches a stack frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check for matching</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if this selector item matches the frame, False otherwise</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Must be implemented by subclasses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="poset-visualization-module">Poset Visualization Module<a class="headerlink" href="#poset-visualization-module" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pychoice.poset"></a>
    <div class="doc doc-contents first">

        <p>Poset (Partially Ordered Set) visualization for PyChoice selectors.</p>
<p>This module provides tools for analyzing and visualizing the relationships
between choice selectors. It builds directed graphs representing the poset
structure of selectors, where edges indicate sub-selector relationships,
helping developers understand rule precedence and specificity.</p>
<p>The poset visualization is particularly useful for debugging complex choice
rule hierarchies and understanding how different selectors relate to each other.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="pychoice.poset.build_selector_poset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_selector_poset</span><span class="p">(</span><span class="n">selectors</span><span class="p">)</span></code>

<a href="#pychoice.poset.build_selector_poset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Build a directed graph representing the partial order of selectors.</p>
<p>Creates a directed acyclic graph (DAG) where nodes represent selectors
and edges represent sub-selector relationships. An edge from A to B
indicates that A is a sub-selector of B (A is more specific than B).</p>
<p>The resulting graph has transitive edges removed for clarity, showing
only the direct relationships between selectors in the hierarchy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selectors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Selector objects to analyze</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NetworkX DiGraph representing the selector poset with transitive </p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reduction applied for visual clarity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">selectors = [
    Selector([app]),
    Selector([app, module]),  
    Selector([app, module, func])
]
graph = build_selector_poset(selectors)
# Graph shows: [app, module, func] -&gt; [app, module] -&gt; [app]
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/poset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_selector_poset</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a directed graph representing the partial order of selectors.</span>

<span class="sd">    Creates a directed acyclic graph (DAG) where nodes represent selectors</span>
<span class="sd">    and edges represent sub-selector relationships. An edge from A to B</span>
<span class="sd">    indicates that A is a sub-selector of B (A is more specific than B).</span>

<span class="sd">    The resulting graph has transitive edges removed for clarity, showing</span>
<span class="sd">    only the direct relationships between selectors in the hierarchy.</span>

<span class="sd">    Args:</span>
<span class="sd">        selectors: List of Selector objects to analyze</span>

<span class="sd">    Returns:</span>
<span class="sd">        NetworkX DiGraph representing the selector poset with transitive </span>
<span class="sd">        reduction applied for visual clarity</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        selectors = [</span>
<span class="sd">            Selector([app]),</span>
<span class="sd">            Selector([app, module]),  </span>
<span class="sd">            Selector([app, module, func])</span>
<span class="sd">        ]</span>
<span class="sd">        graph = build_selector_poset(selectors)</span>
<span class="sd">        # Graph shows: [app, module, func] -&gt; [app, module] -&gt; [app]</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="c1"># Add nodes (each selector becomes a node)</span>
    <span class="k">for</span> <span class="n">sel</span> <span class="ow">in</span> <span class="n">selectors</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">))</span>

    <span class="c1"># Add edges based on sub-selector relationships</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selectors</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selectors</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">cmp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">generic_compare</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># a is a sub-selector of b (more specific than b)</span>
                <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="c1"># Remove transitive edges for clearer visualization</span>
    <span class="c1"># This keeps only direct parent-child relationships</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">transitive_reduction</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.poset.visualize_selector_poset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize_selector_poset</span><span class="p">(</span><span class="n">selectors</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.poset.visualize_selector_poset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Visualize the poset structure of selectors as a graph diagram.</p>
<p>Creates a visual representation of selector relationships using matplotlib
and NetworkX. The graph shows the hierarchy of selectors with arrows
indicating sub-selector relationships (from more specific to less specific).</p>
<p>This visualization helps in understanding:
- Which selectors are more specific than others
- The overall hierarchy of choice rules
- Potential conflicts or overlapping rules
- The precedence order that will be used at runtime</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selectors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Selector (pychoice.args.Selector)" href="#pychoice.args.Selector">Selector</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Selector objects to visualize</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional path to save the visualization. If None, displays interactively</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">from pychoice.poset import visualize_selector_poset

# Create some selectors
selectors = [
    Selector([my_app, greet]),
    Selector([my_app, email_module, greet]),
    Selector([my_app, email_module, formal_context, greet])
]

# Visualize and save to file
visualize_selector_poset(selectors, &quot;selector_hierarchy.png&quot;)

# Or display interactively
visualize_selector_poset(selectors)
</code></pre>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Requires matplotlib and networkx to be installed. The visualization
uses a spring layout algorithm to position nodes, so the exact
layout may vary between runs but the relationships will be consistent.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/poset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_selector_poset</span><span class="p">(</span><span class="n">selectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Selector</span><span class="p">],</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize the poset structure of selectors as a graph diagram.</span>

<span class="sd">    Creates a visual representation of selector relationships using matplotlib</span>
<span class="sd">    and NetworkX. The graph shows the hierarchy of selectors with arrows</span>
<span class="sd">    indicating sub-selector relationships (from more specific to less specific).</span>

<span class="sd">    This visualization helps in understanding:</span>
<span class="sd">    - Which selectors are more specific than others</span>
<span class="sd">    - The overall hierarchy of choice rules</span>
<span class="sd">    - Potential conflicts or overlapping rules</span>
<span class="sd">    - The precedence order that will be used at runtime</span>

<span class="sd">    Args:</span>
<span class="sd">        selectors: List of Selector objects to visualize</span>
<span class="sd">        filename: Optional path to save the visualization. If None, displays interactively</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from pychoice.poset import visualize_selector_poset</span>

<span class="sd">        # Create some selectors</span>
<span class="sd">        selectors = [</span>
<span class="sd">            Selector([my_app, greet]),</span>
<span class="sd">            Selector([my_app, email_module, greet]),</span>
<span class="sd">            Selector([my_app, email_module, formal_context, greet])</span>
<span class="sd">        ]</span>

<span class="sd">        # Visualize and save to file</span>
<span class="sd">        visualize_selector_poset(selectors, &quot;selector_hierarchy.png&quot;)</span>

<span class="sd">        # Or display interactively</span>
<span class="sd">        visualize_selector_poset(selectors)</span>
<span class="sd">        ```</span>

<span class="sd">    Note:</span>
<span class="sd">        Requires matplotlib and networkx to be installed. The visualization</span>
<span class="sd">        uses a spring layout algorithm to position nodes, so the exact</span>
<span class="sd">        layout may vary between runs but the relationships will be consistent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">build_selector_poset</span><span class="p">(</span><span class="n">selectors</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="tracing-functions">Tracing Functions<a class="headerlink" href="#tracing-functions" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pychoice"></a>
    <div class="doc doc-contents first">

        <p>PyChoice: A library for managing choices, options, and configurations across abstraction hierarchy.</p>
<p>PyChoice provides a systematic way to customize function behavior through rules without 
modifying the original functions or breaking abstraction boundaries. It allows for 
complex configuration management and code injection patterns.</p>


<details class="basic-usage" open>
  <summary>Basic usage</summary>
  <pre><code class="language-python">import pychoice as choice

@choice.func(args=[&quot;greeting&quot;])
def greet(name: str, greeting=&quot;Hello&quot;):
    return f&quot;{greeting} {name}&quot;

choice.rule([my_app, greet], greet, greeting=&quot;Hi&quot;)
</code></pre>
</details>








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="pychoice.registry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">registry</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pychoice.registry" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Global registry of all ChoiceFunctions created with @func decorator.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="pychoice.ChoiceContext" class="doc doc-heading">
            <code>ChoiceContext</code>


<a href="#pychoice.ChoiceContext" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Base class for choice contexts that provide temporary rule scoping.</p>
<p>ChoiceContexts allow you to create temporary scopes where specific choice
rules apply. They use Python's context manager protocol and context variables
to track when they are active.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.ChoiceContext.active">active</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ContextVar tracking whether this context is currently active</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">class DebugContext(ChoiceContext):
    pass

with DebugContext():
    # Rules targeting DebugContext will apply here
    my_function()  # May use different implementation
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/selector.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChoiceContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for choice contexts that provide temporary rule scoping.</span>

<span class="sd">    ChoiceContexts allow you to create temporary scopes where specific choice</span>
<span class="sd">    rules apply. They use Python&#39;s context manager protocol and context variables</span>
<span class="sd">    to track when they are active.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        active: ContextVar tracking whether this context is currently active</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        class DebugContext(ChoiceContext):</span>
<span class="sd">            pass</span>

<span class="sd">        with DebugContext():</span>
<span class="sd">            # Rules targeting DebugContext will apply here</span>
<span class="sd">            my_function()  # May use different implementation</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">ContextVar</span><span class="p">(</span><span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">TracebackType</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.Match" class="doc doc-heading">
            <code>Match</code>


<a href="#pychoice.Match" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SelectorItem (pychoice.selector.SelectorItem)" href="#pychoice.selector.SelectorItem">SelectorItem</a></code></p>


        <p>Advanced selector item that matches function calls with specific argument values.</p>
<p>Match extends basic function matching to also check argument values, allowing
for more precise rule targeting based on function parameters.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.Match.item">item</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The underlying SelectorItem to match</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pychoice.Match.match_kwargs">match_kwargs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments that must match for this selector to apply</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Match greet() calls where greeting=&quot;Hi&quot;
match_item = Match(greet, greeting=&quot;Hi&quot;)
selector = Selector([my_app, match_item])
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/funcs.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Match</span><span class="p">(</span><span class="n">SelectorItem</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Advanced selector item that matches function calls with specific argument values.</span>

<span class="sd">    Match extends basic function matching to also check argument values, allowing</span>
<span class="sd">    for more precise rule targeting based on function parameters.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        item: The underlying SelectorItem to match</span>
<span class="sd">        match_kwargs: Keyword arguments that must match for this selector to apply</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Match greet() calls where greeting=&quot;Hi&quot;</span>
<span class="sd">        match_item = Match(greet, greeting=&quot;Hi&quot;)</span>
<span class="sd">        selector = Selector([my_app, match_item])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">SEL_I</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">new_selector_item</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Match</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">item</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">match_kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying callable from the wrapped selector item.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this Match selector matches a stack frame.</span>

<span class="sd">        First checks if the underlying item matches, then verifies that</span>
<span class="sd">        all specified keyword arguments match the actual call arguments.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to check for matching</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if both function and arguments match, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First check if the underlying item matches</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># If no kwargs to match, then it&#39;s a match</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Capture the arguments and compare against expected kwargs</span>
        <span class="n">captured</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>

        <span class="c1"># Check if all expected kwargs match the captured values</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">expected_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captured</span> <span class="ow">or</span> <span class="n">captured</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">capture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture local variables from the matching stack frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_info: Stack frame to capture variables from</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of captured local variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pychoice.Match.capture" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.Match.capture" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Capture local variables from the matching stack frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to capture variables from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of captured local variables</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">capture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Capture local variables from the matching stack frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to capture variables from</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of captured local variables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Selector</span><span class="o">.</span><span class="n">_collect_captures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.Match.get_callable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_callable</span><span class="p">()</span></code>

<a href="#pychoice.Match.get_callable" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the underlying callable from the wrapped selector item.</p>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the underlying callable from the wrapped selector item.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">get_callable</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pychoice.Match.matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span></code>

<a href="#pychoice.Match.matches" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if this Match selector matches a stack frame.</p>
<p>First checks if the underlying item matches, then verifies that
all specified keyword arguments match the actual call arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_info</code>
            </td>
            <td>
                  <code><span title="inspect.FrameInfo">FrameInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stack frame to check for matching</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if both function and arguments match, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_info</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">FrameInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this Match selector matches a stack frame.</span>

<span class="sd">    First checks if the underlying item matches, then verifies that</span>
<span class="sd">    all specified keyword arguments match the actual call arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_info: Stack frame to check for matching</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if both function and arguments match, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First check if the underlying item matches</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">frame_info</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># If no kwargs to match, then it&#39;s a match</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Capture the arguments and compare against expected kwargs</span>
    <span class="n">captured</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="n">frame_info</span><span class="p">)</span>

    <span class="c1"># Check if all expected kwargs match the captured values</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">expected_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">captured</span> <span class="ow">or</span> <span class="n">captured</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected_value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pychoice.MissingChoiceArg" class="doc doc-heading">
            <code>MissingChoiceArg</code>


<a href="#pychoice.MissingChoiceArg" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when a choice function is missing expected arguments.</p>
<p>This occurs when a @choice.func decorator specifies choice arguments that
don't exist as parameters in the decorated function.</p>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func(args=[&quot;nonexistent&quot;])  # This arg doesn't exist
def greet(name: str):  # Missing &quot;nonexistent&quot; parameter
    return f&quot;Hello {name}&quot;
# Raises MissingChoiceArg
</code></pre>
</details>






              <details class="quote">
                <summary>Source code in <code>pychoice/args.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MissingChoiceArg</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a choice function is missing expected arguments.</span>

<span class="sd">    This occurs when a @choice.func decorator specifies choice arguments that</span>
<span class="sd">    don&#39;t exist as parameters in the decorated function.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func(args=[&quot;nonexistent&quot;])  # This arg doesn&#39;t exist</span>
<span class="sd">        def greet(name: str):  # Missing &quot;nonexistent&quot; parameter</span>
<span class="sd">            return f&quot;Hello {name}&quot;</span>
<span class="sd">        # Raises MissingChoiceArg</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">choice_arg</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;The function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is missing the expected choice kwarg </span><span class="si">{</span><span class="n">choice_arg</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pychoice.def_rule" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">def_rule</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span></code>

<a href="#pychoice.def_rule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator for creating dynamic rules with custom logic.</p>
<p>Unlike simple rules created with rule(), def_rule allows you to create
rules with custom logic that can dynamically determine parameter values
based on captured variables from the call stack.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selector</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL">SEL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List defining the call stack pattern to match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function for the rule implementation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.def_rule([debug_mode, log])
def debug_log_rule(captures):
    # Custom logic based on captured variables
    return None, {&quot;level&quot;: &quot;DEBUG&quot;, &quot;verbose&quot;: True}
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">def_rule</span><span class="p">(</span><span class="n">selector</span><span class="p">:</span> <span class="n">SEL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator for creating dynamic rules with custom logic.</span>

<span class="sd">    Unlike simple rules created with rule(), def_rule allows you to create</span>
<span class="sd">    rules with custom logic that can dynamically determine parameter values</span>
<span class="sd">    based on captured variables from the call stack.</span>

<span class="sd">    Args:</span>
<span class="sd">        selector: List defining the call stack pattern to match</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function for the rule implementation</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.def_rule([debug_mode, log])</span>
<span class="sd">        def debug_log_rule(captures):</span>
<span class="sd">            # Custom logic based on captured variables</span>
<span class="sd">            return None, {&quot;level&quot;: &quot;DEBUG&quot;, &quot;verbose&quot;: True}</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">RuleVals</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RuleVals</span><span class="p">:</span>
        <span class="c1"># Choose function implementation</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="n">new_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
        <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">choice_function</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice_fun</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
            <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">,</span> <span class="n">choice_fun</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
        <span class="n">choice_fun</span><span class="o">.</span><span class="n">_add_rule</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.func" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.func" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to create a choice function from a regular function.</p>
<p>This is the primary decorator for creating choice functions. It converts
a regular function into a ChoiceFunction that can be customized through rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names that can be customized by rules</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]], <a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function that converts a function to a ChoiceFunction</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.func(args=[&quot;greeting&quot;, &quot;punctuation&quot;])
def greet(name: str, greeting=&quot;Hello&quot;, punctuation=&quot;!&quot;):
    return f&quot;{greeting} {name}{punctuation}&quot;
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]],</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create a choice function from a regular function.</span>

<span class="sd">    This is the primary decorator for creating choice functions. It converts</span>
<span class="sd">    a regular function into a ChoiceFunction that can be customized through rules.</span>

<span class="sd">    Args:</span>
<span class="sd">        args: List of parameter names that can be customized by rules</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function that converts a function to a ChoiceFunction</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.func(args=[&quot;greeting&quot;, &quot;punctuation&quot;])</span>
<span class="sd">        def greet(name: str, greeting=&quot;Hello&quot;, punctuation=&quot;!&quot;):</span>
<span class="sd">            return f&quot;{greeting} {name}{punctuation}&quot;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
        <span class="n">func_args</span> <span class="o">=</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="c1"># Choice interface</span>

        <span class="c1"># Add to registry</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">func_args</span><span class="p">)</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>

        <span class="c1"># Return wrapper</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">reg</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.impl" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">impl</span><span class="p">(</span><span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.impl" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to create alternative implementations for choice functions.</p>
<p>This decorator creates alternative implementations that can be used by
rules to completely replace the behavior of a choice function in specific contexts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>implements</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction this will be an implementation for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names this implementation accepts</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]], <a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator function that creates a ChoiceFuncImplementation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">@choice.impl(implements=greet, args=[&quot;greeting&quot;, &quot;title&quot;])
def formal_greet(name: str, greeting=&quot;Dear&quot;, title=&quot;&quot;):
    return f&quot;{greeting} {title} {name}&quot;
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">impl</span><span class="p">[</span><span class="n">O</span><span class="p">](</span>
    <span class="n">implements</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">]],</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to create alternative implementations for choice functions.</span>

<span class="sd">    This decorator creates alternative implementations that can be used by</span>
<span class="sd">    rules to completely replace the behavior of a choice function in specific contexts.</span>

<span class="sd">    Args:</span>
<span class="sd">        implements: The ChoiceFunction this will be an implementation for</span>
<span class="sd">        args: List of parameter names this implementation accepts</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator function that creates a ChoiceFuncImplementation</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @choice.impl(implements=greet, args=[&quot;greeting&quot;, &quot;title&quot;])</span>
<span class="sd">        def formal_greet(name: str, greeting=&quot;Dear&quot;, title=&quot;&quot;):</span>
<span class="sd">            return f&quot;{greeting} {title} {name}&quot;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator_args</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
        <span class="n">func_args</span> <span class="o">=</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">](</span><span class="n">args</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="c1"># Choice implementation</span>

        <span class="c1"># Add to registry</span>
        <span class="n">implements</span><span class="o">.</span><span class="n">_add_func</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">func_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">func_args</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">decorator_args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.rule" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">impl</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pychoice.rule" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a choice rule that customizes function behavior in specific contexts.</p>
<p>Rules define when and how to customize choice functions. They specify a selector
(which determines when the rule applies) and either an alternative implementation
or parameter overrides.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>selector</code>
            </td>
            <td>
                  <code><span title="pychoice.selector.SEL">SEL</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List defining the call stack pattern to match</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impl</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a> | <a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ChoiceFunction, ChoiceFuncImplementation, or None for parameter-only rules</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter values to apply when this rule matches</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python"># Parameter-only rule
choice.rule([my_app, greet], greet, greeting=&quot;Hi&quot;)

# Implementation-switching rule
choice.rule([formal_context, greet], formal_greet_impl)
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule</span><span class="p">(</span><span class="n">selector</span><span class="p">:</span> <span class="n">SEL</span><span class="p">,</span> <span class="n">impl</span><span class="p">:</span> <span class="n">ChoiceFunction</span> <span class="o">|</span> <span class="n">ChoiceFuncImplementation</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a choice rule that customizes function behavior in specific contexts.</span>

<span class="sd">    Rules define when and how to customize choice functions. They specify a selector</span>
<span class="sd">    (which determines when the rule applies) and either an alternative implementation</span>
<span class="sd">    or parameter overrides.</span>

<span class="sd">    Args:</span>
<span class="sd">        selector: List defining the call stack pattern to match</span>
<span class="sd">        impl: ChoiceFunction, ChoiceFuncImplementation, or None for parameter-only rules</span>
<span class="sd">        **kwargs: Parameter values to apply when this rule matches</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Parameter-only rule</span>
<span class="sd">        choice.rule([my_app, greet], greet, greeting=&quot;Hi&quot;)</span>

<span class="sd">        # Implementation-switching rule</span>
<span class="sd">        choice.rule([formal_context, greet], formal_greet_impl)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">impl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Allow None implementation for args-only rules</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">interface</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">impl</span><span class="p">,</span> <span class="n">ChoiceFuncImplementation</span><span class="p">):</span>
        <span class="n">processed_impl</span> <span class="o">=</span> <span class="n">impl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NonRule</span><span class="p">()</span>
    <span class="c1"># Choose function implementation</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">new_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">processed_impl</span><span class="p">)</span> <span class="k">if</span> <span class="n">processed_impl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">choice_function</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice_fun</span><span class="p">,</span> <span class="n">ChoiceFunction</span><span class="p">):</span>
        <span class="n">choice_fun</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ChoiceFunction</span><span class="p">,</span> <span class="n">choice_fun</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
    <span class="n">choice_fun</span><span class="o">.</span><span class="n">_add_rule</span><span class="p">(</span><span class="n">Rule</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">processed_impl</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="p">(</span><span class="n">processed_impl</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.trace_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trace_start</span><span class="p">()</span></code>

<a href="#pychoice.trace_start" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Start tracing choice function calls.</p>
<p>Begins recording all choice function invocations and rule applications.
Use this to debug and understand which choices are being made in your application.</p>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">choice.trace_start()
my_application()  # Run your code
trace = choice.trace_stop()
print(trace)  # See what choices were made
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trace_start</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start tracing choice function calls.</span>

<span class="sd">    Begins recording all choice function invocations and rule applications.</span>
<span class="sd">    Use this to debug and understand which choices are being made in your application.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        choice.trace_start()</span>
<span class="sd">        my_application()  # Run your code</span>
<span class="sd">        trace = choice.trace_stop()</span>
<span class="sd">        print(trace)  # See what choices were made</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">trace_status</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.trace_stop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trace_stop</span><span class="p">()</span></code>

<a href="#pychoice.trace_stop" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Stop tracing and return the collected trace data.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Trace</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Trace (pychoice.funcs.Trace)" href="#pychoice.funcs.Trace">Trace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A trace object containing all choice function calls and decisions
   made since trace_start() was called.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">choice.trace_start()
my_application()
trace = choice.trace_stop()
trace.save(&quot;choices.json&quot;)  # Save for analysis
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trace_stop</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Trace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop tracing and return the collected trace data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Trace: A trace object containing all choice function calls and decisions</span>
<span class="sd">               made since trace_start() was called.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        choice.trace_start()</span>
<span class="sd">        my_application()</span>
<span class="sd">        trace = choice.trace_stop()</span>
<span class="sd">        trace.save(&quot;choices.json&quot;)  # Save for analysis</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">trace_status</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pychoice.wrap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wrap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pychoice.wrap" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert an existing function into a choice function implementation.</p>
<p>This is a non-decorator alternative to @impl for when you want to convert
an existing function into a choice implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>implements</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFunction (pychoice.funcs.ChoiceFunction)" href="#pychoice.funcs.ChoiceFunction">ChoiceFunction</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ChoiceFunction this will implement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names this implementation accepts</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ChoiceFuncImplementation (pychoice.args.ChoiceFuncImplementation)" href="#pychoice.args.ChoiceFuncImplementation">ChoiceFuncImplementation</a>[<span title="O">O</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ChoiceFuncImplementation wrapping the provided function</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">def existing_greet(name: str, style=&quot;casual&quot;):
    return f&quot;Hey {name}!&quot;

casual_impl = choice.wrap(existing_greet, greet, args=[&quot;style&quot;])
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>pychoice/funcs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wrap</span><span class="p">[</span><span class="n">O</span><span class="p">](</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="n">implements</span><span class="p">:</span> <span class="n">ChoiceFunction</span><span class="p">[</span><span class="n">O</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChoiceFuncImplementation</span><span class="p">[</span><span class="n">O</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an existing function into a choice function implementation.</span>

<span class="sd">    This is a non-decorator alternative to @impl for when you want to convert</span>
<span class="sd">    an existing function into a choice implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        f: The function to convert</span>
<span class="sd">        implements: The ChoiceFunction this will implement</span>
<span class="sd">        args: List of parameter names this implementation accepts</span>

<span class="sd">    Returns:</span>
<span class="sd">        ChoiceFuncImplementation wrapping the provided function</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        def existing_greet(name: str, style=&quot;casual&quot;):</span>
<span class="sd">            return f&quot;Hey {name}!&quot;</span>

<span class="sd">        casual_impl = choice.wrap(existing_greet, greet, args=[&quot;style&quot;])</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">impl</span><span class="p">(</span><span class="n">implements</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://zachgk.com">zachgk</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/zachgk/PyChoice" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/PyChoice" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>